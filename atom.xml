<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Poetry&#39;s Blog</title>
  
  <subtitle>Choose a gesture to allow yourself to live irreplaceable.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.poetries.top/"/>
  <updated>2017-10-15T13:34:11.956Z</updated>
  <id>http://blog.poetries.top/</id>
  
  <author>
    <name>Poetry</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Nodejs之基础API（三）</title>
    <link href="http://blog.poetries.top/2017/10/15/node-base-api/"/>
    <id>http://blog.poetries.top/2017/10/15/node-base-api/</id>
    <published>2017-10-15T12:50:35.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h2><blockquote><p>提供了一些工具函数，用于处理文件与目录的路径</p></blockquote><p><strong>basename、dirname与extname</strong></p><ul><li>返回一个 <code>path</code>的最后一部分</li><li>返回一个 <code>path</code> 的目录名</li><li>返回 <code>path</code> 的扩展名</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123;basename,dirname,extname&#125; = <span class="built_in">require</span>(<span class="string">"path"</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> filePath = <span class="string">"/usr/local/bin/test.txt"</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(basename(filePath)); <span class="comment">// test.txt</span></div><div class="line"><span class="built_in">console</span>.log(dirname(filePath)); <span class="comment">// /usr/local/bin</span></div><div class="line"><span class="built_in">console</span>.log(extname(filePath)); <span class="comment">// .txt</span></div></pre></td></tr></table></figure><p><strong>join、normalize与resolve</strong></p><ul><li><code>path.join()</code>方法使用平台特定的分隔符把全部给定的 <code>path</code> 片段连接到一起，并规范化生成的路径</li><li><code>path.normalize()</code> 方法会规范化给定的 <code>path</code>，并解析 <code>&#39;..&#39;</code>和 <code>&#39;.&#39;</code>片段</li><li><code>path.resolve()</code> 方法会把一个相对路径解析为一个绝对路径</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">path.join(<span class="string">'/foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz/asdf'</span>, <span class="string">'quux'</span>, <span class="string">'..'</span>);</div><div class="line"><span class="comment">// 返回: '/foo/bar/baz/asdf'</span></div><div class="line"></div><div class="line">path.join(<span class="string">'foo'</span>, &#123;&#125;, <span class="string">'bar'</span>);</div><div class="line"><span class="comment">// 抛出 'TypeError: Path must be a string. Received &#123;&#125;'</span></div></pre></td></tr></table></figure><p><strong>path.format与path.parse</strong></p><ul><li><code>path.format()</code>方法会从一个对象返回一个路径字符串。 与 <code>path.parse()</code> 相反</li><li><code>path.parse()</code>方法返回一个对象，对象的属性表示 <code>path</code> 的元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123;parse,format&#125; = <span class="built_in">require</span>(<span class="string">"path"</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> filePath = <span class="string">"/usr/local/bin/test.txt"</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> parse_ret = parse(filePath);</div><div class="line"><span class="keyword">const</span> format_ret = format(parse_ret)</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(parse_ret);</div><div class="line"><span class="built_in">console</span>.log(format_ret);</div></pre></td></tr></table></figure><ul><li>结果</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123; <span class="attr">root</span>: <span class="string">'/'</span>,</div><div class="line">  dir: <span class="string">'/usr/local/bin'</span>,</div><div class="line">  base: <span class="string">'test.txt'</span>,</div><div class="line">  ext: <span class="string">'.txt'</span>,</div><div class="line">  name: <span class="string">'test'</span> &#125;</div><div class="line">/usr/local/bin\test.txt</div></pre></td></tr></table></figure><p><strong>sep、delimiter、win32、posix</strong></p><blockquote><p>和操作系统有关的东西</p></blockquote><ul><li><code>sep</code>：提供了平台特定的路径片段分隔符<ul><li><code>Windows</code> 上是<code>\</code></li><li><code>POSIX</code> 上是 <code>/</code></li></ul></li><li><code>path.win32</code>提供了 <code>path</code> 方法针对<code>Windows</code> 的实现</li><li><code>posix</code>   属性提供了 <code>path</code>方法针对 <code>POSIX</code> 的实现</li><li><code>delimiter</code> 就是 <code>&quot;:&quot;</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123;sep,delimiter,win32,posix&#125; = <span class="built_in">require</span>(<span class="string">"path"</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> filePath = <span class="string">"/usr/local/bin/test.txt"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"sep "</span>,sep);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"posix sep "</span>,posix.sep);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"win32 sep "</span>,win32.sep);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"PATH"</span>,process.env.PATH);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"delimiter "</span>,delimiter);</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sep  \</div><div class="line">posix sep  /</div><div class="line">win32 sep  \</div><div class="line">PATH C:\Python27\;C:\Python27\Scripts;C:\Windows\system32;C:\Windows;C:\Windows\</div><div class="line">System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1<span class="number">.0</span>\;C:\Program Files\Git\b</div><div class="line"><span class="keyword">in</span>;C:\Program Files\nodejs;;e:\Program Files\VS Code\bin;C:\Users\Administrator\</div><div class="line">AppData\Roaming\npm;.;;.;;.;</div><div class="line">delimiter  ;</div></pre></td></tr></table></figure><p><strong>回顾小结</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>)</div><div class="line"></div><div class="line"><span class="comment">// 路径相关</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"__dirname"</span>, __dirname); <span class="comment">//文件夹</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"__filename"</span>, __filename); <span class="comment">//文件名</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"process.cwd()"</span>, process.cwd()); <span class="comment">//绝对路径</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"./"</span>, path.resolve()); <span class="comment">//根据相对路径取得绝对路径</span></div></pre></td></tr></table></figure><ul><li><code>__dirname</code>、<code>__filename</code> 总是返回文件的绝对路径</li><li><code>process.cwd()</code>总是返回<code>node</code>命令所在文件夹（就是用户在哪里启动的<code>node</code>脚本的路径）</li></ul><h2 id="Buffer"><a href="#Buffer" class="headerlink" title="Buffer"></a>Buffer</h2><blockquote><ul><li>buffer用来处理二进制数据流的</li><li>类似于整数数组，大小固定</li></ul><p>Buffer 类在 Node.js 中是一个全局变量，因此无需使用 require(‘buffer’).Buffer</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建一个长度为 10、且用 0 填充的 Buffer。</span></div><div class="line"><span class="keyword">const</span> buf1 = Buffer.alloc(<span class="number">10</span>)</div><div class="line"></div><div class="line"><span class="comment">// 创建一个长度为 10、且用 0x1 填充的 Buffer。 </span></div><div class="line"><span class="keyword">const</span> buf2 = Buffer.alloc(<span class="number">10</span>, <span class="number">1</span>);</div><div class="line"></div><div class="line"><span class="comment">// 创建一个包含 [0x1, 0x2, 0x3] 的 Buffer。</span></div><div class="line"><span class="keyword">const</span> buf4 = Buffer.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div></pre></td></tr></table></figure><p><strong>Buffer类常用的方法</strong></p><ul><li><code>byteLength</code> 计算字符串占了几个字节</li><li><code>Buffer.isBuffer</code>判断是否是<code>buffer</code>对象</li><li><code>Buffer.concat</code>拼接<code>Buffer</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// byteLength 计算字符串占了几个字节</span></div><div class="line"><span class="built_in">console</span>.log(Buffer.byteLength(<span class="string">"test"</span>)) <span class="comment">// 4 </span></div><div class="line"><span class="built_in">console</span>.log(Buffer.byteLength(<span class="string">"测试"</span>))  <span class="comment">// 6字节</span></div><div class="line"></div><div class="line"><span class="comment">// Buffer.isBuffer判断是否是buffer对象</span></div><div class="line"><span class="built_in">console</span>.log(Buffer.isBuffer(&#123;&#125;))</div><div class="line"><span class="built_in">console</span>.log(Buffer.isBuffer(Buffer.from([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])))</div><div class="line"></div><div class="line"><span class="comment">// Buffer.concat拼接Buffer</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> buf1 = Buffer.from(<span class="string">"This "</span>)</div><div class="line"><span class="keyword">const</span> buf2 = Buffer.from(<span class="string">"is "</span>)</div><div class="line"><span class="keyword">const</span> buf3 = Buffer.from(<span class="string">"a "</span>)</div><div class="line"><span class="keyword">const</span> buf4 = Buffer.from(<span class="string">"test "</span>)</div><div class="line"><span class="keyword">const</span> buf5 = Buffer.from(<span class="string">"buffer"</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> buf = Buffer.concat([buf1,buf2,buf3,buf4,buf5]);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(buf.toString());</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">4</span></div><div class="line"><span class="comment">6</span></div><div class="line"><span class="comment">false</span></div><div class="line"><span class="comment">true</span></div><div class="line"><span class="comment">This is a test buffer</span></div><div class="line"><span class="comment">**/</span></div></pre></td></tr></table></figure><p><strong>Buffer实例常用方法</strong></p><ul><li><code>buf.length</code> </li><li><code>buf.toString()</code></li><li><code>buf.fill()</code> 填充一些值</li><li><code>buf.equals()</code> 两个<code>buffer</code>的内容是否相等</li><li><code>buf.indexOf()</code> 找到字符的位置</li><li><code>buf.copy()</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> buf = Buffer.from(<span class="string">"This is a test!"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(buf.length); <span class="comment">// 15</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(buf.toString(<span class="string">"base64"</span>)); </div><div class="line"></div><div class="line"><span class="keyword">const</span> buf1 = Buffer.allocUnsafe(<span class="number">10</span>);</div><div class="line"></div><div class="line"><span class="comment">// buf1.fill填充一些值</span></div><div class="line"><span class="comment">//&lt;Buffer a0 b4 25 00 00 00 00 00 01 00&gt;</span></div><div class="line"><span class="comment">//&lt;Buffer a0 b4 0a 0a 0a 0a 00 00 01 00&gt;</span></div><div class="line"><span class="built_in">console</span>.log(buf1)</div><div class="line"><span class="built_in">console</span>.log(buf1.fill(<span class="number">10</span>,<span class="number">2</span>,<span class="number">6</span>)) <span class="comment">// 从第二个开始到第六个填充10</span></div><div class="line"></div><div class="line"><span class="comment">// buf.equals两个buffer的内容是否相等</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> buf2 = Buffer.from(<span class="string">"test"</span>)</div><div class="line"><span class="keyword">const</span> buf3 = Buffer.from(<span class="string">"test"</span>)</div><div class="line"><span class="keyword">const</span> buf4 = Buffer.from(<span class="string">"test!"</span>)</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(buf2.equals(buf3)) <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(buf2.equals(buf4)) <span class="comment">// false</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// buf.indexOf() 找到字符的位置</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(buf2.indexOf(<span class="string">"es"</span>)); <span class="comment">// 1</span></div><div class="line"><span class="built_in">console</span>.log(buf2.indexOf(<span class="string">"esa"</span>)); <span class="comment">// -1</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 解决中文乱码问题</span></div><div class="line"><span class="keyword">const</span> StringDecoder = <span class="built_in">require</span>(<span class="string">"string_decoder"</span>).StringDecoder;</div><div class="line"><span class="keyword">const</span> decoder = <span class="keyword">new</span> StringDecoder(<span class="string">"utf8"</span>);</div><div class="line"><span class="keyword">const</span> buf5 = Buffer.from(<span class="string">"中文字符串"</span>);</div><div class="line"></div><div class="line"> <span class="comment">// 乱码</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;buf5.length;i+=<span class="number">5</span>) &#123;</div><div class="line"><span class="keyword">const</span> b = Buffer.allocUnsafe(<span class="number">5</span>);</div><div class="line">buf5.copy(b,<span class="number">0</span>,i);</div><div class="line"><span class="built_in">console</span>.log(b.toString());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 不在乱码</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;buf5.length;i+=<span class="number">5</span>) &#123;</div><div class="line"><span class="keyword">const</span> b = Buffer.allocUnsafe(<span class="number">5</span>);</div><div class="line">buf5.copy(b,<span class="number">0</span>,i);</div><div class="line"><span class="built_in">console</span>.log(decoder.write(b));</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="event"><a href="#event" class="headerlink" title="event"></a>event</h2><blockquote><p>大多数 Node.js 核心 API 都采用惯用的异步事件驱动架构，其中某些类型的对象（触发器）会周期性地触发命名事件来调用函数对象（监听器）</p></blockquote><ul><li><code>eventEmitter.on()</code> 方法用于注册监听器，<code>eventEmitter.emit()</code> 方法用于触发事件</li><li>这和在浏览器上不同，在浏览器上靠的是用户做的一些UI的操作触发，如<code>click\hover</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">"events"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 继承EventEmitter类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ce = <span class="keyword">new</span> CustomEvent();</div><div class="line"></div><div class="line"><span class="comment">// 绑定一个事件名 test，完成事件处理程序</span></div><div class="line">ce.on(<span class="string">"test"</span>,()=&gt;&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"This is a test"</span>);</div><div class="line">&#125;)</div><div class="line"></div><div class="line">setInterval(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line"><span class="comment">// emit触发事件</span></div><div class="line">ce.emit(<span class="string">"test"</span>);</div><div class="line">&#125;,<span class="number">500</span>)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">"events"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 继承EventEmitter类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ce = <span class="keyword">new</span> CustomEvent();</div><div class="line"></div><div class="line"><span class="comment">// 绑定事件处理程序</span></div><div class="line">ce.on(<span class="string">"error"</span>,(err,time) =&gt; &#123;</div><div class="line"><span class="built_in">console</span>.log(err);</div><div class="line"><span class="built_in">console</span>.log(time);</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 给事件处理程序传递多个参数</span></div><div class="line">ce.emit(<span class="string">"error"</span>, <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"出错了"</span>),<span class="built_in">Date</span>.now())</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">"events"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 继承EventEmitter类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ce = <span class="keyword">new</span> CustomEvent();</div><div class="line"></div><div class="line"><span class="comment">// once只响应一次事件 如jQuery中的once()</span></div><div class="line">ce.once(<span class="string">"test"</span>,()=&gt; &#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"test event once"</span>);</div><div class="line">&#125;)</div><div class="line"></div><div class="line">setInterval(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line"><span class="comment">// emit触发事件</span></div><div class="line">ce.emit(<span class="string">"test"</span>);</div><div class="line">&#125;,<span class="number">500</span>)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">"events"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 继承EventEmitter类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"fn1"</span>)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"fn2"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ce = <span class="keyword">new</span> CustomEvent();</div><div class="line"></div><div class="line">ce.on(<span class="string">"test"</span>,fn1);</div><div class="line">ce.on(<span class="string">"test"</span>,fn2);</div><div class="line"></div><div class="line">setInterval(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line"><span class="comment">// emit触发事件</span></div><div class="line">ce.emit(<span class="string">"test"</span>);</div><div class="line">&#125;,<span class="number">500</span>)</div><div class="line"></div><div class="line"><span class="comment">// removeListener移除事件</span></div><div class="line">setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line"><span class="comment">// ce.removeListener("test",fn2)</span></div><div class="line">ce.removeAllListeners(<span class="string">"test"</span>); <span class="comment">//移除test绑定的事件</span></div><div class="line">&#125;,<span class="number">1500</span>)</div></pre></td></tr></table></figure><h2 id="fs"><a href="#fs" class="headerlink" title="fs"></a>fs</h2><ul><li>异步方法的最后一个参数都是一个回调函数。 </li><li>传给回调函数的参数取决于具体方法，但回调函数的第一个参数都会保留给异常。 如果操作成功完成，则第一个参数会是 <code>null</code> 或 <code>undefined</code></li><li>当使用同步方法时，任何异常都会被立即抛出。 可以使用   <code>try/catch</code> 来处理异常，或让异常向上冒泡</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 读文件</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="comment">// readFile 异步操作</span></div><div class="line"><span class="comment">// 规范：回调函数的第一个参数都会保留给异常</span></div><div class="line">fs.readFile(<span class="string">"./fs.js"</span>,<span class="string">"utf8"</span>,(err,data)=&gt;&#123;</div><div class="line"><span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line"><span class="built_in">console</span>.log(data);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// readFile 同步操作（同步先执行）</span></div><div class="line"><span class="keyword">const</span> data = fs.readFileSync(<span class="string">"./path.js"</span>,<span class="string">"utf8"</span>);</div><div class="line"><span class="built_in">console</span>.log(data)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 写文件</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">fs.writeFile(<span class="string">"./write.js"</span>,<span class="string">"This is a  test"</span>,&#123;<span class="attr">encoding</span>:<span class="string">"utf8"</span>&#125;,err=&gt;&#123;</div><div class="line"><span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"done"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="comment">//stat文件信息</span></div><div class="line">fs.stat(<span class="string">"./fs.js"</span>,(err,stats)=&gt;&#123;</div><div class="line"><span class="keyword">if</span> (err) &#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"文件不存在"</span>);</div><div class="line"><span class="keyword">return</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(stats.isFile()) <span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(stats.isDirectory()) <span class="comment">//false</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(stats)</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">Stats &#123;</span></div><div class="line"><span class="comment">  dev: -835755091,</span></div><div class="line"><span class="comment">  mode: 33206,</span></div><div class="line"><span class="comment">  nlink: 1,</span></div><div class="line"><span class="comment">  uid: 0,</span></div><div class="line"><span class="comment">  gid: 0,</span></div><div class="line"><span class="comment">  rdev: 0,</span></div><div class="line"><span class="comment">  blksize: undefined,</span></div><div class="line"><span class="comment">  ino: 562949953557826,</span></div><div class="line"><span class="comment">  size: 216,</span></div><div class="line"><span class="comment">  blocks: undefined,</span></div><div class="line"><span class="comment">  atime: 2017-10-15T12:24:01.933Z,</span></div><div class="line"><span class="comment">  mtime: 2017-10-15T12:49:00.341Z,</span></div><div class="line"><span class="comment">  ctime: 2017-10-15T12:49:00.341Z,</span></div><div class="line"><span class="comment">  birthtime: 2017-10-15T12:24:01.871Z</span></div><div class="line"><span class="comment">    &#125;</span></div><div class="line"><span class="comment">  */</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// rename修改文件名</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">fs.rename(<span class="string">"./write.js"</span>,<span class="string">"test.js"</span>,err=&gt;&#123;</div><div class="line"><span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"done"</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// unlink删除文件</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">fs.unlink(<span class="string">"./test.js"</span>,err=&gt;&#123;</div><div class="line"><span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"done"</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 读文件夹相关操作</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">fs.readdir(<span class="string">"./"</span>,(err,files)=&gt;&#123;</div><div class="line"><span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line"><span class="built_in">console</span>.log(files);</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">[ '.vscode',</span></div><div class="line"><span class="comment">  'buffer.js',</span></div><div class="line"><span class="comment">  'events.js',</span></div><div class="line"><span class="comment">  'fs.js',</span></div><div class="line"><span class="comment">  'path.js',</span></div><div class="line"><span class="comment">  'test1.js',</span></div><div class="line"><span class="comment">  'test2.js',</span></div><div class="line"><span class="comment">  'test3.js',</span></div><div class="line"><span class="comment">  'test4.js' ]</span></div><div class="line"><span class="comment"> **/</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建文件夹</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">fs.mkdir(<span class="string">"test"</span>,err=&gt;&#123;&#125;);</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 删除文件夹</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">fs.rmdir(<span class="string">"./test"</span>,err=&gt;&#123;&#125;);</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// watch监视文件变化</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">fs.watch(<span class="string">"./"</span>,&#123;</div><div class="line">recursive: <span class="literal">true</span> <span class="comment">//是否循环递归</span></div><div class="line">&#125;,(eventType,filename) =&gt; &#123;</div><div class="line"><span class="built_in">console</span>.log(eventType, filename)</div><div class="line">&#125;)</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// readStream 流 (从一个方向流向另一个方向)</span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> rs = fs.createReadStream(<span class="string">"./fs.js"</span>);</div><div class="line"></div><div class="line">rs.pipe(process.stdout) <span class="comment">// process.stdout控制台</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// writeStream </span></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> ws = fs.createWriteStream(<span class="string">"./test5.js"</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> time = setInterval(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line"><span class="keyword">const</span> num = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random() * <span class="number">10</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (num &lt; <span class="number">7</span>) &#123;</div><div class="line">ws.write(num + <span class="string">""</span>); <span class="comment">// 需要转成字符串或者buffer才能写入</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">clearInterval(time);</div><div class="line">ws.end();<span class="comment">// 写完数据</span></div><div class="line">&#125;</div><div class="line">&#125;,<span class="number">200</span>)</div><div class="line"></div><div class="line"><span class="comment">// 用事件判断是否写完数据</span></div><div class="line">ws.on(<span class="string">"finish"</span>, () =&gt; &#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"done!"</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure><h2 id="异步解决方案"><a href="#异步解决方案" class="headerlink" title="异步解决方案"></a>异步解决方案</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 异步回调 Node.js v8.0.0版本增加了util.promisify函数</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">const</span> promisify = <span class="built_in">require</span>(<span class="string">"util"</span>).promisify;</div><div class="line"></div><div class="line"><span class="keyword">const</span> read = promisify(fs.readFile); </div><div class="line"></div><div class="line">read(<span class="string">"./callback.js"</span>).then(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(data.toString());</div><div class="line">&#125;).catch(<span class="function"><span class="params">ex</span>=&gt;</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(ex)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// async awit</span></div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line"><span class="keyword">const</span> content = awit read(<span class="string">"./callback.js"</span>);</div><div class="line"><span class="built_in">console</span>.log(content.toString())</div><div class="line">&#125; <span class="keyword">catch</span> (ex) &#123;</div><div class="line"><span class="built_in">console</span>.log(ex)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">test()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Path&quot;&gt;&lt;a href=&quot;#Path&quot; class=&quot;headerlink&quot; title=&quot;Path&quot;&gt;&lt;/a&gt;Path&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;提供了一些工具函数，用于处理文件与目录的路径&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;stro
      
    
    </summary>
    
      <category term="Back-end" scheme="http://blog.poetries.top/categories/Back-end/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="Node" scheme="http://blog.poetries.top/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs之环境&amp;调试（二）</title>
    <link href="http://blog.poetries.top/2017/10/15/node-env-debug/"/>
    <id>http://blog.poetries.top/2017/10/15/node-env-debug/</id>
    <published>2017-10-15T08:30:15.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、环境"><a href="#一、环境" class="headerlink" title="一、环境"></a>一、环境</h2><p><strong>commonJS</strong></p><ul><li><code>nodejs</code>模块管理规范<ul><li>每一个文件是一个模块，有自己的作用域</li><li>在模块内部<code>module</code>变量代表模块本身</li><li><code>module.exports</code>属性代表模块对外接口</li></ul></li></ul><p><strong>exports与module.exports</strong></p><ul><li><code>exports = module.exports</code> <code>exports</code>是<code>module.exports</code>的快捷方式，不能修改<code>exports</code>的指向</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 这种方式修改了exports的指向，这样是不行的</span></div><div class="line">exports = &#123;</div><div class="line">    a:<span class="string">""</span>,</div><div class="line">    b:<span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 这样没问题</span></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    a:<span class="string">""</span>,</div><div class="line">    b:<span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>global</strong></p><blockquote><p>全局访问的属性和方法挂载到global对象中</p></blockquote><ul><li><code>global</code>下的全局属性方法<ul><li><code>commonJS</code></li><li><code>Buffer</code>、<code>process</code>、<code>console</code></li><li><code>timer</code> (<code>setInterval</code>、<code>setTimeout</code>、<code>setImmediate</code>)</li></ul></li></ul><p><strong>process</strong></p><ul><li><strong>process.argv</strong><ul><li>参数相关的东西 <code>argv</code></li><li><code>argv0</code>是<code>argv</code>的第一个参数</li><li><code>execArgv</code>是调用<code>node</code>所传入的一些参数 如<code>node --inspect test.js</code></li><li><code>exevPath</code>调用脚本的路径 <code>C:\Program Files\nodejs\node.exe</code></li><li><code>&gt;node test3.js a=1 a=2 a=3 a=4</code>执行的时候，传入一些外部的命令</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123;argv, argv0, execArgv, exevPath&#125; = process;</div><div class="line"></div><div class="line">argv.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(item);</div><div class="line">    <span class="comment">//C:\Program Files\nodejs\node.exe</span></div><div class="line">    <span class="comment">//C:\Users\Administrator\Desktop\learn_node\test3.js</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><ul><li><strong>process.env</strong></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123;env&#125; = process;</div></pre></td></tr></table></figure><ul><li><strong>process.cwd</strong><ul><li>打印当前路径</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:\Users\Administrator\Desktop\learn_node</div></pre></td></tr></table></figure><ul><li><strong>process.nextTick与setImmediate</strong><ul><li>执行速度： <code>nextTick</code> &gt; <code>setTimeout</code> &gt; <code>setImmediate</code></li><li><code>nextTick</code>在异步之前执行</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// nextTick比setImmediate执行得早</span></div><div class="line">process.nextTick(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">   <span class="comment">// 当前事件队列执行完之后再执行</span></div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"nextTick"</span>) </div><div class="line">&#125;)</div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"setTimeout"</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 在大部分情况下使用setImmediate就行</span></div><div class="line">setImmediate(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"setImmediate"</span>)</div><div class="line">&#125;)</div><div class="line"><span class="comment">//nextTick</span></div><div class="line"><span class="comment">//setImmediate</span></div></pre></td></tr></table></figure><h2 id="二、调试"><a href="#二、调试" class="headerlink" title="二、调试"></a>二、调试</h2><ul><li>官方调试方法 <a href="https://nodejs.org/en/docs/inspector/" target="_blank" rel="external">https://nodejs.org/en/docs/inspector/</a></li></ul><p><strong>方法一：使用inspect</strong></p><ul><li>Option 1: Open <code>chrome://inspect</code> in a Chromium-based browser. Click the Configure button and ensure your target host and port are listed. Then select your Node.js app from the list</li><li>Option 2: <code>Install the Chrome</code>Extension NIM (Node Inspector Manager): <a href="https://chrome.google.com/webstore/detail/nim-node-inspector-manage/gnhhdgbaldcilmgcpfddgdbkhjohddkj" target="_blank" rel="external">https://chrome.google.com/webstore/detail/nim-node-inspector-manage/gnhhdgbaldcilmgcpfddgdbkhjohddkj</a></li></ul><p><strong>方法二：使用VS code</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;一、环境&quot;&gt;&lt;a href=&quot;#一、环境&quot; class=&quot;headerlink&quot; title=&quot;一、环境&quot;&gt;&lt;/a&gt;一、环境&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;commonJS&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;nodejs&lt;/code&gt;模块管理
      
    
    </summary>
    
      <category term="Back-end" scheme="http://blog.poetries.top/categories/Back-end/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="Node" scheme="http://blog.poetries.top/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs之简单入门（一）</title>
    <link href="http://blog.poetries.top/2017/10/15/learn-node-start/"/>
    <id>http://blog.poetries.top/2017/10/15/learn-node-start/</id>
    <published>2017-10-15T03:40:43.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><blockquote><p>nodejs是事件驱动、非阻塞I/O模型</p></blockquote><ul><li>阻塞：i/o时进程休眠等待完成后进行下一步</li><li>非阻塞：i/o时函数立即返回，进程不等待i/o返回</li></ul><blockquote><p>i/o完成后通知主程序，如何告诉呢？通过事件驱动</p></blockquote><p><strong>事件驱动</strong></p><ul><li>i/o等异步操作结束后通知</li><li>内部实现是观察者模式</li></ul><p><strong>CPU密集和I/O密集</strong></p><ul><li><code>CPU</code>密集：压缩、解压、加密、解密</li><li><code>I/O</code>密集：文件操作、网络操作、数据库</li></ul><p><strong>web常见场景(web是一个I/O密集)</strong></p><ul><li>静态资源读取</li><li>数据库操作</li><li>渲染页面</li></ul><p><strong>高并发应用之道</strong></p><ul><li>增加机器数</li><li>增加每台机器CPU数-多核</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/1480597-64c380eb78d068a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><strong>进程、线程</strong></p><ul><li>进程：一个运行的程序（进程包括线程，如何水分子里面还有分子原子）</li><li>线程：进程内一个独立的，可调度的执行单元</li><li>多线程：启动一个进程，在一个进程内启动多个线程，这样多个线程可以执行多个任务</li></ul><p><strong>Nodejs的单线程</strong></p><ul><li>单线程只是针对主进程，I/O操作系统底层多线程调度</li><li>单线程并不是单进程</li></ul><p><strong>Nodejs原理</strong></p><ul><li>Node是单线程的，只开一个进程，一个进程也只开一个线程。一个CPU上只开一个进程，一个进程里面只有一个线程</li></ul><p><strong>nodejs高性能的前提</strong></p><ul><li>高并发</li><li><code>I/O</code>密集</li></ul><p><strong>常用场景</strong></p><ul><li><code>web Server</code></li><li>本地代码构建 (<code>webpack/grunt/gulp</code>)</li><li>使用工具的开发</li></ul><h2 id="二、nodejs与JavaScrip异同"><a href="#二、nodejs与JavaScrip异同" class="headerlink" title="二、nodejs与JavaScrip异同"></a>二、nodejs与JavaScrip异同</h2><ul><li><code>ECMAScript</code></li><li>语法</li><li>内置对象、方法</li></ul><p><strong>顶层对象</strong></p><ul><li><code>JavaScript</code>：<code>window</code></li><li><p><code>nodejs</code>: <code>global</code></p></li><li><p>在ECMA部分node和JavaScript是一样的，比如数据类型的定义，语法结构、内置对象</p></li></ul><h2 id="三、模块"><a href="#三、模块" class="headerlink" title="三、模块 "></a>三、模块 </h2><ul><li>在<code>node</code>中文件和模块是一一对应的，也就是一个文件一个模块。<strong>file是每个模块下必有的一个属性，输出文件的绝对路径。`</strong>dirname` 是文件夹名称绝对路径</li><li>每个模块都有自己的作用域</li><li>我们通过var声明的变量并非全局，而是该模块作用域下的</li></ul><p><strong>模块加载机制</strong></p><ul><li><code>require</code>加载模块</li><li>1、首先按照加载模块的文件名称进行查找</li><li>2、如果没有找到就会在文件模块文件名称后加载<code>.js</code>进行查找</li><li>3、如果还没有找到，就在文件名称后加载<code>.json</code>后缀，进行查找</li><li>4、如果还没找到，就会在文件名称后加上<code>.node</code>进行查找</li><li>查找流程：<strong>文件名称-&gt;.js -&gt; .json-&gt;.node</strong></li></ul><p><strong>exports、module</strong></p><ul><li>保存当前模块有关的一些信息</li><li><code>module.exports</code> 一般使用这个,把一个模块中的变量对外提供访问</li><li>在模块作用域，还有一个内置的模块对象，<code>exports</code>其实就是<code>module.exports</code>,他们两个都是指向同一个对象</li></ul><h2 id="四、node目录的配置"><a href="#四、node目录的配置" class="headerlink" title="四、node目录的配置"></a>四、node目录的配置</h2><ul><li>配置文件 : <code>package.json</code><ul><li>dependencies :  当前项目所使用到的依赖模块</li><li>安装方式: <code>npm install</code> 自动读取<code>package.json</code>自动安装</li></ul></li><li><code>router</code>目录 用来存放路由文件</li><li><code>views</code>目录  用来存放<code>html</code>模板文件</li><li><code>module</code>目录  自己写的一些模块</li></ul><h2 id="五、第一个node服务器"><a href="#五、第一个node服务器" class="headerlink" title="五、第一个node服务器"></a>五、第一个node服务器</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//   安装好node就有的一个模块</span></div><div class="line"><span class="comment">//  用来创建http服务器的</span></div><div class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">`http`</span>);</div><div class="line"></div><div class="line">http.createServer(<span class="function">(<span class="params">request,response</span>) =&gt;</span> &#123;</div><div class="line">    <span class="comment">//request 请求对象     浏览器 请求 服务器所有的内容保存在这个对象里</span></div><div class="line">    <span class="comment">//response 响应对象     服务器响应浏览器 所有的方法</span></div><div class="line">    response.writeHead(<span class="number">200</span> , &#123; <span class="string">'Content-Type'</span>:<span class="string">'text/html'</span> &#125; );</div><div class="line">    <span class="comment">//  .end() 结束响应 同时发送一个 Hello Word</span></div><div class="line">    response.end(<span class="string">'Hello Word'</span>)</div><div class="line">&#125;).listen(<span class="number">233</span>);</div><div class="line"><span class="comment">//.listen(); 监听端口 233  自定义的端口号</span></div><div class="line"><span class="comment">// 如果开启了node服务器  修改完之后的代码必须 重启才能生效</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;一、前言&quot;&gt;&lt;a href=&quot;#一、前言&quot; class=&quot;headerlink&quot; title=&quot;一、前言&quot;&gt;&lt;/a&gt;一、前言&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;nodejs是事件驱动、非阻塞I/O模型&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;阻
      
    
    </summary>
    
      <category term="Back-end" scheme="http://blog.poetries.top/categories/Back-end/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="Node" scheme="http://blog.poetries.top/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>高阶函数map reduce filter</title>
    <link href="http://blog.poetries.top/2017/09/17/map-reduce-filter/"/>
    <id>http://blog.poetries.top/2017/09/17/map-reduce-filter/</id>
    <published>2017-09-17T09:33:00.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>整理于互联网</p></blockquote><h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><hr><ul><li>由于<code>map()</code>方法定义在<code>JavaScript</code>的<code>Array</code>中，我们调用<code>Array</code>的<code>map()</code>方法，传入我们自己的函数，就得到了一个新的<code>Array</code>作为结果</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x * x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line">arr.map(pow); <span class="comment">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></div></pre></td></tr></table></figure><ul><li><code>map()</code>传入的参数是<code>pow</code>，即函数对象本身</li><li><code>map()</code>作为高阶函数，事实上它把运算规则抽象了，因此，我们不但可以计算简单的<code>f(x)=x2</code>，还可以计算任意复杂的函数，比如，把<code>Array</code>的所有数字转为字符串</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line">arr.map(<span class="built_in">String</span>); <span class="comment">// ['1', '2', '3', '4', '5', '6', '7', '8', '9']</span></div></pre></td></tr></table></figure><h2 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h2><hr><blockquote><p>再看<code>reduce</code>的用法。<code>Array</code>的<code>reduce()</code>把一个函数作用在这个<code>Array</code>的<code>[x1, x2, x3...]</code>上，这个函数必须接收两个参数，<code>reduce()</code>把结果继续和序列的下一个元素做累积计算，其效果就是：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)</div></pre></td></tr></table></figure><ul><li>比方说对一个<code>Array</code>求和，就可以用<code>reduce</code>实现</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</div><div class="line">arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x + y;</div><div class="line">&#125;); <span class="comment">// 25</span></div></pre></td></tr></table></figure><ul><li>要把<code>[1, 3, 5, 7, 9]</code>变换成整数<code>13579</code>，<code>reduce()</code>也能派上用场</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</div><div class="line">arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x * <span class="number">10</span> + y;</div><div class="line">&#125;); <span class="comment">// 13579</span></div></pre></td></tr></table></figure><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><hr><ul><li><code>filter</code>也是一个常用的操作，它用于把<code>Array</code>的某些元素过滤掉，然后返回剩下的元素</li></ul><blockquote><p>和<code>map()</code>类似，<code>Array</code>的<code>filter()</code>也接收一个函数。和<code>map()</code>不同的是，<code>filter()</code>把传入的函数依次作用于每个元素，然后根据返回值是<code>true</code>还是<code>false</code>决定保留还是丢弃该元素</p></blockquote><ul><li>例如，在一个<code>Array</code>中，删掉偶数，只保留奇数，可以这么写：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>];</div><div class="line"><span class="keyword">var</span> r = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x % <span class="number">2</span> !== <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line">r; <span class="comment">// [1, 5, 9, 15]</span></div></pre></td></tr></table></figure><ul><li>把一个<code>Array</code>中的空字符串删掉，可以这么写：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'A'</span>, <span class="string">''</span>, <span class="string">'B'</span>, <span class="literal">null</span>, <span class="literal">undefined</span>, <span class="string">'C'</span>, <span class="string">'  '</span>];</div><div class="line"><span class="keyword">var</span> r = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">s</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> s &amp;&amp; s.trim(); <span class="comment">// 注意：IE9以下的版本没有trim()方法</span></div><div class="line">&#125;);</div><div class="line">r; <span class="comment">// ['A', 'B', 'C']</span></div></pre></td></tr></table></figure><ul><li>可见用<code>filter()</code>这个高阶函数，关键在于正确实现一个“筛选”函数</li></ul><p><strong>回调函数</strong></p><blockquote><p><code>filter()</code>接收的回调函数，其实可以有多个参数。通常我们仅使用第一个参数，表示<code>Array</code>的某个元素。回调函数还可以接收另外两个参数，表示元素的位置和数组本身：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line"><span class="keyword">var</span> r = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">element, index, self</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(element); <span class="comment">// 依次打印'A', 'B', 'C'</span></div><div class="line">    <span class="built_in">console</span>.log(index); <span class="comment">// 依次打印0, 1, 2</span></div><div class="line">    <span class="built_in">console</span>.log(self); <span class="comment">// self就是变量arr</span></div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><ul><li>利用<code>filter</code>，可以巧妙地去除<code>Array</code>的重复元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> r;</div><div class="line"><span class="keyword">var</span> arr = [<span class="string">'apple'</span>, <span class="string">'strawberry'</span>, <span class="string">'banana'</span>, <span class="string">'pear'</span>, <span class="string">'apple'</span>, <span class="string">'orange'</span>, <span class="string">'orange'</span>, <span class="string">'strawberry'</span>];</div><div class="line">r = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">element, index, self</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> self.indexOf(element) === index;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><ul><li><p>去除重复元素依靠的是<code>indexOf</code>总是返回第一个元素的位置，后续的重复元素位置与<code>indexOf</code>返回的位置不相等，因此被<code>filter</code>滤掉了</p></li><li><p>用<code>filter()</code>筛选出素数</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">arr.filter(<span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">element,index,self</span>)</span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">2</span>;i&lt;element;i++)&#123;</div><div class="line">        <span class="keyword">if</span>(element%i === <span class="number">0</span>)</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(element === i)</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><h2 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h2><hr><blockquote><p>排序也是在程序中经常用到的算法。无论使用冒泡排序还是快速排序，排序的核心是比较两个元素的大小。如果是数字，我们可以直接比较，但如果是字符串或者两个对象呢？直接比较数学上的大小是没有意义的，因此，比较的过程必须通过函数抽象出来。通常规定，对于两个元素x和y，如果认为x &lt; y，则返回-1，如果认为x == y，则返回0，如果认为x &gt; y，则返回1，这样，排序算法就不用关心具体的比较过程，而是根据比较结果直接排序</p></blockquote><ul><li><code>JavaScript</code>的<code>Array</code>的<code>sort()</code>方法就是用于排序的，但是排序结果可能让你大吃一惊：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 看上去正常的结果:</span></div><div class="line">[<span class="string">'Google'</span>, <span class="string">'Apple'</span>, <span class="string">'Microsoft'</span>].sort(); <span class="comment">// ['Apple', 'Google', 'Microsoft'];</span></div><div class="line"></div><div class="line"><span class="comment">// apple排在了最后:</span></div><div class="line">[<span class="string">'Google'</span>, <span class="string">'apple'</span>, <span class="string">'Microsoft'</span>].sort(); <span class="comment">// ['Google', 'Microsoft", 'apple']</span></div><div class="line"></div><div class="line"><span class="comment">// 无法理解的结果:</span></div><div class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>].sort(); <span class="comment">// [1, 10, 2, 20]</span></div></pre></td></tr></table></figure><ul><li><code>Array</code>的<code>sort()</code>方法默认把所有元素先转换为<code>String</code>再排序，结果<code>&#39;10&#39;</code>排在了<code>&#39;2&#39;</code>的前面，因为字符<code>&#39;1&#39;</code>比字符<code>&#39;2&#39;</code>的<code>ASCII</code>码小</li><li>如果不知道<code>sort()</code>方法的默认排序规则，直接对数字排序，绝对栽进坑里！</li><li>幸运的是，<code>sort()</code>方法也是一个高阶函数，它还可以接收一个比较函数来实现自定义的排序</li><li>要按数字大小排序，我们可以这么写</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</div><div class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (x &lt; y) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (x &gt; y) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;); <span class="comment">// [1, 2, 10, 20]</span></div></pre></td></tr></table></figure><ul><li>如果要倒序排序，我们可以把大的数放前面：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</div><div class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (x &lt; y) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (x &gt; y) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;); <span class="comment">// [20, 10, 2, 1]</span></div></pre></td></tr></table></figure><ul><li>默认情况下，对字符串排序，是按照<code>ASCII</code>的大小比较的，现在，我们提出排序应该忽略大小写，按照字母序排序。要实现这个算法，不必对现有代码大加改动，只要我们能定义出忽略大小写的比较算法就可以：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'Google'</span>, <span class="string">'apple'</span>, <span class="string">'Microsoft'</span>];</div><div class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">s1, s2</span>) </span>&#123;</div><div class="line">    x1 = s1.toUpperCase();</div><div class="line">    x2 = s2.toUpperCase();</div><div class="line">    <span class="keyword">if</span> (x1 &lt; x2) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (x1 &gt; x2) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;); <span class="comment">// ['apple', 'Google', 'Microsoft']</span></div></pre></td></tr></table></figure><ul><li>忽略大小写来比较两个字符串，实际上就是先把字符串都变成大写（或者都变成小写），再比较</li></ul><p><strong>最后友情提示，<code>sort()</code>方法会直接对<code>Array</code>进行修改，它返回的结果仍是当前<code>Array</code></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a1 = [<span class="string">'B'</span>, <span class="string">'A'</span>, <span class="string">'C'</span>];</div><div class="line"><span class="keyword">var</span> a2 = a1.sort();</div><div class="line">a1; <span class="comment">// ['A', 'B', 'C']</span></div><div class="line">a2; <span class="comment">// ['A', 'B', 'C']</span></div><div class="line">a1 === a2; <span class="comment">// true, a1和a2是同一对象</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;整理于互联网&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;map&quot;&gt;&lt;a href=&quot;#map&quot; class=&quot;headerlink&quot; title=&quot;map&quot;&gt;&lt;/a&gt;map&lt;/h2&gt;&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;由于&lt;code&gt;map()&lt;
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="高阶函数" scheme="http://blog.poetries.top/tags/%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>Set与Map</title>
    <link href="http://blog.poetries.top/2017/09/17/set-map/"/>
    <id>http://blog.poetries.top/2017/09/17/set-map/</id>
    <published>2017-09-17T06:33:00.000Z</published>
    <updated>2017-10-15T13:34:11.960Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><ul><li>Map是一组键值对的结构，具有极快的查找速度</li><li>用Map实现，只需要一个“名字”-“成绩”的对照表，直接根据名字查找成绩，无论这个表有多大，查找速度都不会变慢。用JavaScript写一个Map如下：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">'Michael'</span>, <span class="number">95</span>], [<span class="string">'Bob'</span>, <span class="number">75</span>], [<span class="string">'Tracy'</span>, <span class="number">85</span>]]);</div><div class="line">m.get(<span class="string">'Michael'</span>); <span class="comment">// 95</span></div></pre></td></tr></table></figure><ul><li>初始化Map需要一个二维数组，或者直接初始化一个空Map。Map具有以下方法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>(); <span class="comment">// 空Map</span></div><div class="line">m.set(<span class="string">'Adam'</span>, <span class="number">67</span>); <span class="comment">// 添加新的key-value</span></div><div class="line">m.set(<span class="string">'Bob'</span>, <span class="number">59</span>);</div><div class="line">m.has(<span class="string">'Adam'</span>); <span class="comment">// 是否存在key 'Adam': true</span></div><div class="line">m.get(<span class="string">'Adam'</span>); <span class="comment">// 67</span></div><div class="line">m.delete(<span class="string">'Adam'</span>); <span class="comment">// 删除key 'Adam'</span></div><div class="line">m.get(<span class="string">'Adam'</span>); <span class="comment">// undefined</span></div></pre></td></tr></table></figure><ul><li>由于一个key只能对应一个value，所以，多次对一个key放入value，后面的值会把前面的值冲掉</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">m.set(<span class="string">'Adam'</span>, <span class="number">67</span>);</div><div class="line">m.set(<span class="string">'Adam'</span>, <span class="number">88</span>);</div><div class="line">m.get(<span class="string">'Adam'</span>); <span class="comment">// 88</span></div></pre></td></tr></table></figure><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><blockquote><p>Set和Map类似，也是一组key的集合，但不存储value。由于key不能重复，所以，在Set中，没有重复的key</p></blockquote><ul><li>要创建一个Set，需要提供一个Array作为输入，或者直接创建一个空Set</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s1 = <span class="keyword">new</span> <span class="built_in">Set</span>(); <span class="comment">// 空Set</span></div><div class="line"><span class="keyword">var</span> s2 = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); <span class="comment">// 含1, 2, 3</span></div></pre></td></tr></table></figure><ul><li>重复元素在Set中自动被过滤</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="string">'3'</span>]);</div><div class="line">s; <span class="comment">// Set &#123;1, 2, 3, "3"&#125;</span></div></pre></td></tr></table></figure><ul><li>通过add(key)方法可以添加元素到Set中，可以重复添加，但不会有效果</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; s.add(<span class="number">4</span>)</div><div class="line">&gt;&gt;&gt; s</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</div><div class="line">&gt;&gt;&gt; s.add(<span class="number">4</span>)</div><div class="line">&gt;&gt;&gt; s</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</div></pre></td></tr></table></figure><ul><li>通过delete(key)方法可以删除元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line">s; <span class="comment">// Set &#123;1, 2, 3&#125;</span></div><div class="line">s.delete(<span class="number">3</span>);</div><div class="line">s; <span class="comment">// Set &#123;1, 2&#125;</span></div></pre></td></tr></table></figure><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><ul><li>Map和Set是ES6标准新增的数据类型，请根据浏览器的支持情况决定是否要使用</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Map&quot;&gt;&lt;a href=&quot;#Map&quot; class=&quot;headerlink&quot; title=&quot;Map&quot;&gt;&lt;/a&gt;Map&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Map是一组键值对的结构，具有极快的查找速度&lt;/li&gt;
&lt;li&gt;用Map实现，只需要一个“名字”-“成绩”的对照表，直接
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="ES6" scheme="http://blog.poetries.top/tags/ES6/"/>
    
  </entry>
  
  <entry>
    <title>web开发中跨域解决方案</title>
    <link href="http://blog.poetries.top/2017/09/17/cross-domain/"/>
    <id>http://blog.poetries.top/2017/09/17/cross-domain/</id>
    <published>2017-09-17T03:40:43.000Z</published>
    <updated>2017-10-15T13:34:11.932Z</updated>
    
    <content type="html"><![CDATA[<p><strong>什么是跨域？</strong></p><ul><li>概念如下：只要协议、域名、端口有任何一个不同，都被当作是不同的域</li></ul><p><strong>下面是具体的跨域情况详解</strong></p><table><thead><tr><th>URL</th><th>说明</th><th>是否允许通信</th></tr></thead><tbody><tr><td><a href="http://www.a.com/a.js、http://www.a.com/b.js" target="_blank" rel="external">http://www.a.com/a.js、http://www.a.com/b.js</a></td><td>同一域名下</td><td>允许</td></tr><tr><td><a href="http://www.a.com/lab/a.js、http://www.a.com/script/b.js" target="_blank" rel="external">http://www.a.com/lab/a.js、http://www.a.com/script/b.js</a></td><td>同一域名下不同文件夹</td><td>允许</td></tr><tr><td><a href="http://www.a.com:8000/a.js、http://www.a.com/b.js" target="_blank" rel="external">http://www.a.com:8000/a.js、http://www.a.com/b.js</a></td><td>同一域名，不同端口</td><td>不允许</td></tr><tr><td><a href="http://www.a.com/a.js、https://www.a.com/b.js" target="_blank" rel="external">http://www.a.com/a.js、https://www.a.com/b.js</a></td><td>同一域名，不同协议</td><td>不允许</td></tr><tr><td><a href="http://www.a.com/a.js、http://70.32.92.74/b.js" target="_blank" rel="external">http://www.a.com/a.js、http://70.32.92.74/b.js</a></td><td>域名和域名对应ip</td><td>不允许</td></tr><tr><td><a href="http://www.a.com/a.js、http://script.a.com/b.js" target="_blank" rel="external">http://www.a.com/a.js、http://script.a.com/b.js</a></td><td>主域相同，子域不同</td><td>不允许（cookie这种情况下也不允许访问）</td></tr><tr><td><a href="http://www.a.com/a.js、http://a.com/b.js" target="_blank" rel="external">http://www.a.com/a.js、http://a.com/b.js</a></td><td>同一域名，不同二级域名（同上）</td><td>不允许（cookie这种情况下也不允许访问）</td></tr><tr><td><a href="http://www.cnblogs.com/a.js、http://www.a.com/b.js" target="_blank" rel="external">http://www.cnblogs.com/a.js、http://www.a.com/b.js</a></td><td>不同域名</td><td>不允许</td></tr></tbody></table><h2 id="一、document-domain跨域"><a href="#一、document-domain跨域" class="headerlink" title="一、document.domain跨域"></a>一、document.domain跨域</h2><hr><ul><li>原理：相同主域名不同子域名下的页面，可以设置<code>document.domain</code>让它们同域</li><li>限制：同域<code>document</code>提供的是页面间的互操作，需要载入<code>iframe</code>页面</li></ul><blockquote><p>下面几个域名下的页面都是可以通过<code>document.domain</code>跨域互操作的： <code>http://a.com/foo</code>, <code>http://b.a.com/bar</code>, <code>http://c.a.com/bar</code>。 但只能以页面嵌套的方式来进行页面互操作，比如常见的<code>iframe</code>方式就可以完成页面嵌套</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// URL http://a.com/foo</span></div><div class="line"><span class="keyword">var</span> ifr = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</div><div class="line">ifr.src = <span class="string">'http://b.a.com/bar'</span>; </div><div class="line">ifr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> ifrdoc = ifr.contentDocument || ifr.contentWindow.document;</div><div class="line">    ifrdoc.getElementsById(<span class="string">"foo"</span>).innerHTML);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">ifr.style.display = <span class="string">'none'</span>;</div><div class="line"><span class="built_in">document</span>.body.appendChild(ifr);</div></pre></td></tr></table></figure><ul><li>上述代码所在的<code>URL</code>是<code>http://a.com/foo</code>，它对<code>http://b.a.com/bar</code>的<code>DOM</code>访问要求后者将 <code>document.domain</code>往上设置一级</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// URL http://b.a.com/bar</span></div><div class="line"><span class="built_in">document</span>.domain = <span class="string">'a.com'</span></div></pre></td></tr></table></figure><ul><li><code>document.domain</code>只能从子域设置到主域，往下设置以及往其他域名设置都是不允许的， 在<code>Chrome</code>中给出的错误是这样的</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Uncaught DOMException: Failed to set the <span class="string">'domain'</span> property on <span class="string">'Document'</span>: <span class="string">'baidu.com'</span> is not a suffix <span class="keyword">of</span> <span class="string">'b.a.com'</span></div></pre></td></tr></table></figure><h2 id="二、有src的标签"><a href="#二、有src的标签" class="headerlink" title="二、有src的标签"></a>二、有src的标签</h2><hr><ul><li>原理：所有具有<code>src</code>属性的<code>HTML</code>标签都是可以跨域的，包括<code>&lt;img&gt;</code>, <code>&lt;script&gt;</code></li><li>限制：需要创建一个<code>DOM</code>对象，只能用于<code>GET</code>方法</li></ul><blockquote><ul><li>在<code>document.body</code>中<code>append</code>一个具有<code>src</code>属性的<code>HTML</code>标签， <code>src</code>属性值指向的<code>URL</code>会以<code>GET</code>方法被访问，该访问是可以跨域的 </li><li>其实样式表的<code>&lt;link&gt;</code>标签也是可以跨域的，只要是有<code>src</code>或<code>href</code>的<code>HTML</code>标签都有跨域的能力</li></ul></blockquote><ul><li>不同的<code>HTML</code>标签发送<code>HTTP</code>请求的时机不同，例如<code>&lt;img&gt;</code>在更改<code>src</code>属性时就会发送请求，而<code>script</code>, <code>iframe</code>, <code>link[rel=stylesheet]</code>只有在添加到<code>DOM</code>树之后才会发送<code>HTTP</code>请求：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">img.src = <span class="string">'http://some/picture'</span>;        <span class="comment">// 发送HTTP请求</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> ifr = $(<span class="string">'&lt;iframe&gt;'</span>, &#123;<span class="attr">src</span>: <span class="string">'http://b.a.com/bar'</span>&#125;);</div><div class="line">$(<span class="string">'body'</span>).append(ifr);                  <span class="comment">// 发送HTTP请求</span></div></pre></td></tr></table></figure><h2 id="三、JSONP"><a href="#三、JSONP" class="headerlink" title="三、JSONP"></a>三、JSONP</h2><hr><ul><li>原理：<code>&lt;script&gt;</code>是可以跨域的，而且在跨域脚本中可以直接回调当前脚本的函数</li><li>限制：需要创建一个<code>DOM</code>对象并且添加到<code>DOM</code>树，只能用于<code>GET</code>方法</li></ul><blockquote><p><code>JSONP</code>利用的是<code>&lt;script&gt;</code>可以跨域的特性，跨域<code>URL</code>返回的脚本不仅包含数据，还包含一个回调</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// URL: http://b.a.com/foo</span></div><div class="line"><span class="keyword">var</span> data = &#123;</div><div class="line">    foo: <span class="string">'bar'</span>,</div><div class="line">    bar: <span class="string">'foo'</span></div><div class="line">&#125;;</div><div class="line">callback(data);</div></pre></td></tr></table></figure><ul><li>然后在我们在主站<code>http://a.com</code>中，可以这样来跨域获取<code>http://b.a.com</code>的数据：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// URL: http://a.com/foo</span></div><div class="line"><span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    <span class="comment">// 处理跨域请求得到的数据</span></div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> script = $(<span class="string">'&lt;script&gt;'</span>, &#123;<span class="attr">src</span>: <span class="string">'http://b.a.com/bar'</span>&#125;);</div><div class="line">$(<span class="string">'body'</span>).append(script);</div></pre></td></tr></table></figure><ul><li>其实<code>jQuery</code>已经封装了<code>JSONP</code>的使用，我们可以这样来</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$.getJSON( <span class="string">"http://b.a.com/bar?callback=callback"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> data </span>)</span>&#123;</div><div class="line">    <span class="comment">// 处理跨域请求得到的数据</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure><blockquote><p><code>$.getJSON</code>与<code>$.get</code>的区别是前者会把<code>responseText</code>转换为<code>JSON</code>，而且当<code>URL</code>具有<code>callback</code>参数时， <code>jQuery</code>将会把它解释为一个<code>JSONP</code>请求，创建一个<code>&lt;script&gt;</code>标签来完成该请求</p></blockquote><h2 id="四、navigation-对象"><a href="#四、navigation-对象" class="headerlink" title="四、navigation 对象"></a>四、navigation 对象</h2><hr><ul><li>原理：<code>iframe</code>之间是共享<code>navigator</code>对象的，用它来传递信息</li><li>要求：<code>IE6/7</code></li></ul><blockquote><p>有些人注意到了<code>IE6/7</code>的一个漏洞：<code>iframe</code>之间的<code>window.navigator</code>对象是共享的。 我们可以把它作为一个<code>Messenger</code>，通过它来传递信息。比如一个简单的委托：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// a.com</span></div><div class="line">navigation.onData()&#123;</div><div class="line">    <span class="comment">// 数据到达的处理函数</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">typeof</span> navigation.getData === <span class="string">'function'</span> </div><div class="line">    || navigation.getData()</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// b.com</span></div><div class="line">navigation.getData = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $.get(<span class="string">'/path/under/b.com'</span>)</div><div class="line">        .success(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">            <span class="keyword">typeof</span> navigation.onData === <span class="string">'function'</span></div><div class="line">                || navigation.onData(data)</div><div class="line">        &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><blockquote><p>与<code>document.navigator</code>类似，<code>window.name</code>也是当前窗口所有页面所共享的。也可以用它来传递信息。 同样蛋疼的办法还有传递<code>Hash</code>（有些人叫锚点），这是因为每次浏览器打开一个<code>URL</code>时，<code>URL</code>后面的<code>#xxx</code>部分会保留下来，那么新的页面可以从这里获得上一个页面的数据</p></blockquote><h2 id="五、跨域资源共享（CORS）"><a href="#五、跨域资源共享（CORS）" class="headerlink" title="五、跨域资源共享（CORS）"></a>五、跨域资源共享（CORS）</h2><hr><ul><li>原理：服务器设置<code>Access-Control-Allow-OriginHTTP</code>响应头之后，浏览器将会允许跨域请求</li><li>限制：浏览器需要支持<code>HTML5</code>，可以支持<code>POST</code>，<code>PUT</code>等方法</li></ul><blockquote><p>前面提到的跨域手段都是某种意义上的<code>Hack</code>， <code>HTML5</code>标准中提出的跨域资源共享（<code>Cross Origin Resource Share</code>，<code>CORS</code>）才是正道。 它支持其他的<code>HTTP</code>方法如<code>PUT</code>, <code>POST</code>等，可以从本质上解决跨域问题。</p></blockquote><ul><li>例如，从<code>http://a.com</code>要访问<code>http://b.com</code>的数据，通常情况下<code>Chrome</code>会因跨域请求而报错</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">XMLHttpRequest cannot load http:<span class="comment">//b.com. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://a.com' is therefore not allowed access</span></div></pre></td></tr></table></figure><ul><li>错误原因是被请求资源没有设置<code>Access-Control-Allow-Origin</code>，所以我们在<code>b.com</code>的服务器中设置这个响应头字段即可</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Origin: *              # 允许所有域名访问，或者</div><div class="line">Access-Control-Allow-Origin: http:<span class="comment">//a.com   # 只允许所有域名访问</span></div></pre></td></tr></table></figure><h2 id="六、window-postMessage"><a href="#六、window-postMessage" class="headerlink" title="六、window.postMessage"></a>六、window.postMessage</h2><hr><ul><li>原理：<code>HTML5</code>允许窗口之间发送消息</li><li>限制：浏览器需要支持<code>HTML5</code>，获取窗口句柄后才能相互通信</li></ul><blockquote><p>这是一个安全的跨域通信方法，<code>postMessage(message,targetOrigin)</code>也是<code>HTML5</code>引入的特性。 可以给任何一个<code>window</code>发送消息，不论是否同源。第二个参数可以是*但如果你设置了一个<code>URL</code>但不相符，那么该事件不会被分发。看一个普通的使用方式吧</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// URL: http://a.com/foo</span></div><div class="line"><span class="keyword">var</span> win = <span class="built_in">window</span>.open(<span class="string">'http://b.com/bar'</span>);</div><div class="line">win.postMessage(<span class="string">'Hello, bar!'</span>, <span class="string">'http://b.com'</span>);</div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// URL: http://b.com/bar</span></div><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'message'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(event.data);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><h2 id="七、访问控制安全的讨论"><a href="#七、访问控制安全的讨论" class="headerlink" title="七、访问控制安全的讨论"></a>七、访问控制安全的讨论</h2><hr><ul><li>在<code>HTML5</code>之前，<code>JSONP</code>已经成为跨域的事实标准了，<code>jQuery</code>都给出了支持。 值得注意的是它只是<code>Hack</code>，并没有产生额外的安全问题。 因为<code>JSONP</code>要成功获取数据，需要跨域资源所在服务器的配合，比如资源所在服务器需要自愿地回调一个合适的函数，所以服务器仍然有能力控制资源的跨域访问</li><li>跨域的正道还是要使用<code>HTML5</code>提供的CORS头字段以及<code>window.postMessage</code>， 可以支持<code>POST</code>, <code>PUT</code>等<code>HTTP</code>方法，从机制上解决跨域问题。 值得注意的是<code>Access-Control-Allow-Origin</code>头字段是资源所在服务器设置的， 访问控制的责任仍然是在提供资源的服务器一方，这和<code>JSONP</code>是一样的</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;什么是跨域？&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;概念如下：只要协议、域名、端口有任何一个不同，都被当作是不同的域&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;下面是具体的跨域情况详解&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="跨域" scheme="http://blog.poetries.top/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>JS计算字符串所占字节数</title>
    <link href="http://blog.poetries.top/2017/09/12/js-calc-str-byte/"/>
    <id>http://blog.poetries.top/2017/09/12/js-calc-str-byte/</id>
    <published>2017-09-12T11:40:43.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 计算字符串所占的内存字节数，默认使用UTF-8的编码方式计算，也可制定为UTF-16</span></div><div class="line"><span class="comment"> * UTF-8 是一种可变长度的 Unicode 编码格式，使用一至四个字节为每个字符编码</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * 000000 - 00007F(128个代码)      0zzzzzzz(00-7F)                             一个字节</span></div><div class="line"><span class="comment"> * 000080 - 0007FF(1920个代码)     110yyyyy(C0-DF) 10zzzzzz(80-BF)             两个字节</span></div><div class="line"><span class="comment"> * 000800 - 00D7FF </span></div><div class="line"><span class="comment">   00E000 - 00FFFF(61440个代码)    1110xxxx(E0-EF) 10yyyyyy 10zzzzzz           三个字节</span></div><div class="line"><span class="comment"> * 010000 - 10FFFF(1048576个代码)  11110www(F0-F7) 10xxxxxx 10yyyyyy 10zzzzzz  四个字节</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * 注: Unicode在范围 D800-DFFF 中不存在任何字符</span></div><div class="line"><span class="comment"> * &#123;@link http://zh.wikipedia.org/wiki/UTF-8&#125;</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * UTF-16 大部分使用两个字节编码，编码超出 65535 的使用四个字节</span></div><div class="line"><span class="comment"> * 000000 - 00FFFF  两个字节</span></div><div class="line"><span class="comment"> * 010000 - 10FFFF  四个字节</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * &#123;@link http://zh.wikipedia.org/wiki/UTF-16&#125;</span></div><div class="line"><span class="comment"> * @param  &#123;String&#125; str </span></div><div class="line"><span class="comment"> * @param  &#123;String&#125; charset utf-8, utf-16</span></div><div class="line"><span class="comment"> * @return &#123;Number&#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line">     </div><div class="line">    <span class="keyword">var</span> sizeof = <span class="function"><span class="keyword">function</span>(<span class="params">str, charset</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> total = <span class="number">0</span>,</div><div class="line">            charCode,</div><div class="line">            i,</div><div class="line">            len;</div><div class="line">        charset = charset ? charset.toLowerCase() : <span class="string">''</span>;</div><div class="line">        <span class="keyword">if</span>(charset === <span class="string">'utf-16'</span> || charset === <span class="string">'utf16'</span>)&#123;</div><div class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>, len = str.length; i &lt; len; i++)&#123;</div><div class="line">                charCode = str.charCodeAt(i);</div><div class="line">                <span class="keyword">if</span>(charCode &lt;= <span class="number">0xffff</span>)&#123;</div><div class="line">                    total += <span class="number">2</span>;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    total += <span class="number">4</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>, len = str.length; i &lt; len; i++)&#123;</div><div class="line">                charCode = str.charCodeAt(i);</div><div class="line">                <span class="keyword">if</span>(charCode &lt;= <span class="number">0x007f</span>) &#123;</div><div class="line">                    total += <span class="number">1</span>;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(charCode &lt;= <span class="number">0x07ff</span>)&#123;</div><div class="line">                    total += <span class="number">2</span>;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(charCode &lt;= <span class="number">0xffff</span>)&#123;</div><div class="line">                    total += <span class="number">3</span>;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    total += <span class="number">4</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> total;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>iframe+表单跨域提交POST请求</title>
    <link href="http://blog.poetries.top/2017/09/04/js_post/"/>
    <id>http://blog.poetries.top/2017/09/04/js_post/</id>
    <published>2017-09-04T01:30:43.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<h2 id="虚拟表单的形式提交post请求"><a href="#虚拟表单的形式提交post请求" class="headerlink" title="虚拟表单的形式提交post请求"></a>虚拟表单的形式提交post请求</h2><ul><li>现需要把数据源解析提交到表单，创建一个隐藏的表单、隐藏的<code>iframe</code>,表单的target指向<code>iframe</code>的<code>name</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var str = &apos;hfrom_handle=206438&amp;dnid=&amp;dgroup_items__x_countz_=1&amp;dgroup_items=1&amp;dgroup_items_group=dl%2ets&amp;dgroup_items_mirror_count=1&amp;dgroup_items_flags__x_countz_=1&amp;dgroup_items_flags=4&amp;dgroup_items_keys__x_countz_=1&amp;dgroup_items_keys=1jfiegbp3oyma&amp;dgroup_items_tokens__x_countz_=1&amp;dgroup_items_tokens=123456&amp;dgroup_items_datas__x_countz_=1&amp;dgroup_items_datas=&#123;%22key%22%3a%221jfiegbp3oyma%22,%22type%22%3a%22test%2epcba%22,%22time%22%3a%2220170904004724%2e838%22,%22g%22%3a[&#123;%22n%22%3a%22mfc%22,%22p%22%3a[&#123;%22n%22%3a%22factory%22,%22v%22%3a%22%22&#125;,&#123;%22n%22%3a%22operator%22,%22v%22%3a%22xiaoming%22&#125;,&#123;%22n%22%3a%22work%2eorder%22,%22v%22%3a%221889%22&#125;,&#123;%22n%22%3a%22materal%2ecode%22,%22v%22%3a%22%22&#125;,&#123;%22n%22%3a%22materal%2edesc%22,%22v%22%3a%22%22&#125;]&#125;,&#123;%22n%22%3a%22env%22,%22p%22%3a[&#123;%22n%22%3a%22dev%2ehardware%2ecpu%2emodel%22,%22v%22%3a%22gm8136%22&#125;,&#123;%22n%22%3a%22dev%2ehardware%2emodel%22,%22v%22%3a%22f127%22&#125;,&#123;%22n%22%3a%22dev%2ehardware%2esensor%2emodel%22,%22v%22%3a%22soih42%22&#125;,&#123;%22n%22%3a%22dev%2ehardware%2ewifi%2emac%22,%22v%22%3a%2228%3af3%3a66%3a1c%3aac%3a30%22&#125;,&#123;%22n%22%3a%22dev%2ehardware%2ewifi%2emodel%22,%22v%22%3a%22rtl8188%22&#125;,&#123;%22n%22%3a%22dev%2eversion%2ecurrent%22,%22v%22%3a%22v4%2e8%2e1%2e1708141702%22&#125;,&#123;%22n%22%3a%22vtest%5fver%22,%22v%22%3a%224%2e8%2e1%2e1708031358%22&#125;,&#123;%22n%22%3a%22dev%2eversion%2ebase%22,%22v%22%3a%22v3%2e3%2e2%2e1603301301%22&#125;,&#123;%22n%22%3a%22pc%2eip%2epublic%22,%22v%22%3a%22120%2e236%2e230%2e234%22&#125;,&#123;%22n%22%3a%22pc%2eip%2eprivate%22,%22v%22%3a%22192%2e168%2e3%2e180%22&#125;]&#125;,&#123;%22n%22%3a%22appearance%22,%22p%22%3a[&#123;%22n%22%3a%22result%22,%22v%22%3a%22ok%22&#125;,&#123;%22n%22%3a%22duration%22,%22v%22%3a%221605ms%22&#125;]&#125;,&#123;%22n%22%3a%22wifi%5fsignal%22,%22p%22%3a[&#123;%22n%22%3a%22quality%22,%22v%22%3a%2284%22&#125;,&#123;%22n%22%3a%22ssid%22,%22v%22%3a%22HW11%22&#125;,&#123;%22n%22%3a%22result%22,%22v%22%3a%22ok%22&#125;]&#125;,&#123;%22n%22%3a%22activate%22,%22p%22%3a[&#123;%22n%22%3a%22result%22,%22v%22%3a%22ccm%2esecurity%5fchip%2eactived%22&#125;,&#123;%22n%22%3a%22code%22,%22v%22%3a%22%22&#125;]&#125;]&#125;&amp;dgroup_items_offsets__x_countz_=1&amp;dgroup_items_offsets=0&apos;</div></pre></td></tr></table></figure><ul><li>解码后的数据</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/1480597-06cd3b80809500c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><ul><li><p>创建一个隐藏的<code>input(type=&quot;hidden&quot;)</code>,然后把解码得到的数据处理填充到<code>input</code>的<code>name</code> <code>value</code>中，最后通过表单提交到<code>iframe</code>，此过程提交不会刷新页面</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*iframe post cross domain*/</span></div><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">js_iframe</span>(<span class="params">c</span>) </span>&#123;</div><div class="line">     <span class="keyword">var</span> i, e, key, n, v, inp, a, form, iframe;</div><div class="line">      </div><div class="line">     <span class="comment">// 原理：创建一个隐藏的form、一个隐藏的iframe,把表单的target指向iframe的name即可</span></div><div class="line">     form = <span class="built_in">document</span>.createElement(<span class="string">"form"</span>);</div><div class="line">     iframe = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);</div><div class="line">     iframe.style.display = <span class="string">"none"</span>;</div><div class="line">     iframe.name = <span class="string">"frame_post"</span>;</div><div class="line">     <span class="built_in">document</span>.body.appendChild(iframe);</div><div class="line"></div><div class="line">     form.action = url;</div><div class="line">     form.target = <span class="string">"frame_post"</span>;</div><div class="line">     form.method = <span class="string">"post"</span>;</div><div class="line">     form.style.display = <span class="string">"none"</span>;</div><div class="line">     <span class="keyword">for</span>(i = <span class="number">0</span>, a = (<span class="built_in">decodeURIComponent</span>(str)).split(<span class="string">"&amp;"</span>);i&lt;a.length;i++) &#123;</div><div class="line">         inp = <span class="built_in">document</span>.createElement(<span class="string">"input"</span>);</div><div class="line">         e = a[i].split(<span class="string">"="</span>)</div><div class="line">         inp.type = <span class="string">"hidden"</span>;</div><div class="line">         inp.name = e[<span class="number">0</span>];</div><div class="line">         inp.value = e[<span class="number">1</span>];</div><div class="line">         form.appendChild(inp);</div><div class="line">     &#125;</div><div class="line">     <span class="built_in">document</span>.body.appendChild(form);</div><div class="line">     form.submit(); </div><div class="line"> &#125;</div></pre></td></tr></table></figure></li><li><p>提交后表单处理的结果是这样：<br><img src="http://upload-images.jianshu.io/upload_images/1480597-b684987076cf78b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;虚拟表单的形式提交post请求&quot;&gt;&lt;a href=&quot;#虚拟表单的形式提交post请求&quot; class=&quot;headerlink&quot; title=&quot;虚拟表单的形式提交post请求&quot;&gt;&lt;/a&gt;虚拟表单的形式提交post请求&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;现需要把数据源解析提交到
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="跨域" scheme="http://blog.poetries.top/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>浅谈JavaScript中的异步处理</title>
    <link href="http://blog.poetries.top/2017/08/27/js_cb_promise_generator_async/"/>
    <id>http://blog.poetries.top/2017/08/27/js_cb_promise_generator_async/</id>
    <published>2017-08-27T03:40:43.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>整理于互联网</p><ul><li>在<code>JavaScript</code>的世界中，所有代码都是单线程执行的</li><li>由于这个“缺陷”，导致<code>JavaScript</code>的所有网络操作，浏览器事件，都必须是异步执行。异步执行可以用回调函数实现</li><li>异步操作会在将来的某个时间点触发一个函数调用</li></ul></blockquote><ul><li>主流的异步处理方案主要有：回调函数<code>(CallBack)</code>、<code>Promise</code>、<code>Generator</code>函数、<code>async/await</code>。</li></ul><h2 id="一、回调函数-CallBack"><a href="#一、回调函数-CallBack" class="headerlink" title="一、回调函数(CallBack)"></a>一、回调函数(CallBack)</h2><hr><ul><li>这是异步编程最基本的方法</li><li>假设我们有一个 <code>getData</code> 方法，用于异步获取数据，第一个参数为请求的 <code>url</code> 地址，第二个参数是回调函数，如下：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span> (<span class="params">url, callBack</span>) </span>&#123;</div><div class="line">    <span class="comment">// 模拟发送网络请求</span></div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="comment">// 假设 res 就是返回的数据</span></div><div class="line">        <span class="keyword">var</span> res = &#123;</div><div class="line">            url: url,</div><div class="line">            data: <span class="built_in">Math</span>.random()</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 执行回调，将数据作为参数传递</span></div><div class="line">        callBack(res)</div><div class="line">    &#125;, <span class="number">1000</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>我们预先设定一个场景，假设我们要请求三次服务器，每一次的请求依赖上一次请求的结果，如下：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">getData(<span class="string">'/page/1?param=123'</span>, (res1) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(res1)</div><div class="line">    getData(<span class="string">`/page/2?param=<span class="subst">$&#123;res1.data&#125;</span>`</span>, (res2) =&gt; &#123;</div><div class="line">        <span class="built_in">console</span>.log(res2)</div><div class="line">        getData(<span class="string">`/page/3?param=<span class="subst">$&#123;res2.data&#125;</span>`</span>, (res3) =&gt; &#123;</div><div class="line">            <span class="built_in">console</span>.log(res3)</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure><ul><li><p>通过上面的代码可以看出，第一次请求的 <code>url</code> 地址为：<code>/page/1?param=123</code>，返回结果为 <code>res1</code>。</p></li><li><p>第二个请求的 <code>url</code> 地址为：<code>/page/2?param=${res1.data}</code>，依赖第<code>一次请求的</code>res1.data<code>，返回结果为</code>res2`。</p></li><li><p>第三次请求的 <code>url</code>地址为：<code>/page/3?param=${res2.data}</code>，依赖第二次请求的 <code>res2.data</code>，返回结果为 <code>res3</code>。</p></li><li><p>由于后续请求依赖前一个请求的结果，所以我们只能把下一次请求写到上一次请求的回调函数内部，这样就形成了常说的：回调地狱。</p></li></ul><h2 id="二、发布-订阅"><a href="#二、发布-订阅" class="headerlink" title="二、发布/订阅"></a>二、发布/订阅</h2><blockquote><p>我们假定，存在一个”信号中心”，某个任务执行完成，就向信号中心”发布”（<code>publish</code>）一个信号，其他任务可以向信号中心”订阅”（<code>subscribe</code>）这个信号，从而知道什么时候自己可以开始执行。这就叫做”发布/订阅模式”（publish-subscribe pattern），又称”观察者模式”（observer pattern）</p></blockquote><ul><li>这个模式有多种实现，下面采用的是Ben Alman的<a href="https://gist.github.com/661855" target="_blank" rel="external">Tiny Pub/Sub</a>，这是<code>jQuery</code>的一个插件</li><li>首先，<code>f2</code>向”信号中心”<code>jQuery</code>订阅”<code>done</code>“信号</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jQuery.subscribe(<span class="string">"done"</span>, f2);</div></pre></td></tr></table></figure><ul><li>f1进行如下改写</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>)</span>&#123;</div><div class="line">　　　　setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">　　　　　　<span class="comment">// f1的任务代码</span></div><div class="line">　　　　　　jQuery.publish(<span class="string">"done"</span>);</div><div class="line">　　　　&#125;, <span class="number">1000</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li><code>jQuery.publish(&quot;done&quot;)</code>的意思是，<code>f1</code>执行完成后，向”信号中心<code>&quot;jQuery</code>发布<code>&quot;done&quot;</code>信号，从而引发f2的执行。 此外，f2完成执行后，也可以取消订阅（<code>unsubscribe</code>）</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jQuery.unsubscribe(<span class="string">"done"</span>, f2);</div></pre></td></tr></table></figure><ul><li>这种方法的性质与”事件监听”类似，但是明显优于后者。因为我们可以通过查看”消息中心”，了解存在多少信号、每个信号有多少订阅者，从而监控程序的运行。</li></ul><h2 id="三、Promise"><a href="#三、Promise" class="headerlink" title="三、Promise"></a>三、Promise</h2><hr><blockquote><ul><li><code>Promise</code> 是异步编程的一种解决方案，比传统的解决方案——回调函数和事件——更合理和更强大</li><li>所谓<code>Promise</code>，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。从语法上说，<code>Promise</code> 是一个对象，从它可以获取异步操作的消息。<code>Promise</code> 提供统一的 <code>API</code>，各种异步操作都可以用同样的方法进行处理</li></ul></blockquote><ul><li>简单说，它的思想是，每一个异步任务返回一个<code>Promise</code>对象，该对象有一个<code>then</code>方法，允许指定回调函数。</li><li>现在我们使用 <code>Promise</code> 重新实现上面的案例，首先，我们要把异步请求数据的方法封装成 <code>Promise</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDataAsync</span> (<span class="params">url</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="keyword">var</span> res = &#123;</div><div class="line">                url: url,</div><div class="line">                data: <span class="built_in">Math</span>.random()</div><div class="line">            &#125;</div><div class="line">            resolve(res)</div><div class="line">        &#125;, <span class="number">1000</span>)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>那么请求的代码应该这样写</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">getDataAsync(<span class="string">'/page/1?param=123'</span>)</div><div class="line">    .then(<span class="function"><span class="params">res1</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(res1)</div><div class="line">        <span class="keyword">return</span> getDataAsync(<span class="string">`/page/2?param=<span class="subst">$&#123;res1.data&#125;</span>`</span>)</div><div class="line">    &#125;)</div><div class="line">    .then(<span class="function"><span class="params">res2</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(res2)</div><div class="line">        <span class="keyword">return</span> getDataAsync(<span class="string">`/page/3?param=<span class="subst">$&#123;res2.data&#125;</span>`</span>)</div><div class="line">    &#125;)</div><div class="line">    .then(<span class="function"><span class="params">res3</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(res3)</div><div class="line">    &#125;)</div></pre></td></tr></table></figure><ul><li><code>then</code> 方法返回一个新的 <code>Promise</code> 对象，<code>then</code> 方法的链式调用避免了 <code>CallBack</code> 回调地狱</li><li>但也并不是完美，比如我们要添加很多 <code>then</code> 语句， 每一个 <code>then</code> 还是要写一个回调。</li><li>如果场景再复杂一点，比如后边的每一个请求依赖前面所有请求的结果，而不仅仅依赖上一次请求的结果，那会更复杂。 为了做的更好，<code>async/await</code> 就应运而生了，来看看使用 <code>async/await</code> 要如何实现</li></ul><h2 id="四、async-await"><a href="#四、async-await" class="headerlink" title="四、async/await"></a>四、async/await</h2><hr><ul><li><p><code>await</code>后面必须是一个<code>Promise</code>对象</p></li><li><p><code>getDataAsync</code> 方法不变，如下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getDataAsync</span> (<span class="params">url</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="keyword">var</span> res = &#123;</div><div class="line">                url: url,</div><div class="line">                data: <span class="built_in">Math</span>.random()</div><div class="line">            &#125;</div><div class="line">            resolve(res)</div><div class="line">        &#125;, <span class="number">1000</span>)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>业务代码如下</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getData</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> res1 = <span class="keyword">await</span> getDataAsync(<span class="string">'/page/1?param=123'</span>)</div><div class="line">    <span class="built_in">console</span>.log(res1)</div><div class="line">    <span class="keyword">var</span> res2 = <span class="keyword">await</span> getDataAsync(<span class="string">`/page/2?param=<span class="subst">$&#123;res1.data&#125;</span>`</span>)</div><div class="line">    <span class="built_in">console</span>.log(res2)</div><div class="line">    <span class="keyword">var</span> res3 = <span class="keyword">await</span> getDataAsync(<span class="string">`/page/2?param=<span class="subst">$&#123;res2.data&#125;</span>`</span>)</div><div class="line">    <span class="built_in">console</span>.log(res3)</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>可以看到使用<code>async\await</code>就像写同步代码一样</li><li>对比 <code>Promise</code> 感觉怎么样？是不是非常清晰，但是 <code>async/await</code> 是基于 <code>Promise</code> 的，因为使用 <code>async</code> 修饰的方法最终返回一个 <code>Promise</code>， 实际上，<code>async/await</code> 可以看做是使用 <code>Generator</code> 函数处理异步的语法糖，我们来看看如何使用 <code>Generator</code> 函数处理异步</li></ul><h2 id="五、Generator"><a href="#五、Generator" class="headerlink" title="五、Generator"></a>五、Generator</h2><hr><ul><li>首先异步函数依然是</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDataAsync</span> (<span class="params">url</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="keyword">var</span> res = &#123;</div><div class="line">                url: url,</div><div class="line">                data: <span class="built_in">Math</span>.random()</div><div class="line">            &#125;</div><div class="line">            resolve(res)</div><div class="line">        &#125;, <span class="number">1000</span>)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>使用 <code>Generator</code> 函数可以这样写</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> * <span class="title">getData</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> res1 = <span class="keyword">yield</span> getDataAsync(<span class="string">'/page/1?param=123'</span>)</div><div class="line">    <span class="built_in">console</span>.log(res1)</div><div class="line">    <span class="keyword">var</span> res2 = <span class="keyword">yield</span> getDataAsync(<span class="string">`/page/2?param=<span class="subst">$&#123;res1.data&#125;</span>`</span>)</div><div class="line">    <span class="built_in">console</span>.log(res2)</div><div class="line">    <span class="keyword">var</span> res3 = <span class="keyword">yield</span> getDataAsync(<span class="string">`/page/2?param=<span class="subst">$&#123;res2.data&#125;</span>`</span>)</div><div class="line">    <span class="built_in">console</span>.log(res3))</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>然后我们这样逐步执行</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = getData()</div><div class="line">g.next().value.then(<span class="function"><span class="params">res1</span> =&gt;</span> &#123;</div><div class="line">    g.next(res1).value.then(<span class="function"><span class="params">res2</span> =&gt;</span> &#123;</div><div class="line">        g.next(res2).value.then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            g.next()</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure><ul><li>上面的代码，我们逐步调用遍历器的 <code>next()</code> 方法，由于每一个 <code>next()</code> 方法返回值的 <code>value</code> 属性为一个 <code>Promise</code>对象</li><li>所以我们为其添加 <code>then</code> 方法， 在 <code>then</code> 方法里面接着运行 <code>next</code> 方法挪移遍历器指针，直到 <code>Generator</code> 函数运行完成，实际上，这个过程我们不必手动完成，可以封装成一个简单的执行器</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span> (<span class="params">gen</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> g = gen()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">next</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> res = g.next(data)</div><div class="line">        <span class="keyword">if</span> (res.done) <span class="keyword">return</span> res.value</div><div class="line">        res.value.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</div><div class="line">            next(data)</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    next()</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><blockquote><p>run 方法用来自动运行异步的 Generator 函数，其实就是一个递归的过程调用的过程。这样我们就不必手动执行 Generator 函数了。 有了 run 方法，我们只需要这样运行 getData 方法</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">run(getData)</div></pre></td></tr></table></figure><blockquote><p>这样，我们就可以把异步操作封装到 <code>Generator</code> 函数内部，使用 <code>run</code> 方法作为 <code>Generator</code> 函数的自执行器，来处理异步。其实我们不难发现， <code>async/await</code> 方法相比于 <code>Generator</code> 处理异步的方式，有很多相似的地方，只不过 <code>async/await</code> 在语义化方面更加明显，同时 <code>async/await</code> 不需要我们手写执行器，其内部已经帮我们封装好了，这就是为什么说 <code>async/await</code> 是 <code>Generator</code> 函数处理异步的语法糖了</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;整理于互联网&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在&lt;code&gt;JavaScript&lt;/code&gt;的世界中，所有代码都是单线程执行的&lt;/li&gt;
&lt;li&gt;由于这个“缺陷”，导致&lt;code&gt;JavaScript&lt;/code&gt;的所有网络操作，浏览器事件，都必须是异
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="异步回调" scheme="http://blog.poetries.top/tags/%E5%BC%82%E6%AD%A5%E5%9B%9E%E8%B0%83/"/>
    
  </entry>
  
  <entry>
    <title>移动端meta标签一览</title>
    <link href="http://blog.poetries.top/2017/08/23/mobile_meta_summary/"/>
    <id>http://blog.poetries.top/2017/08/23/mobile_meta_summary/</id>
    <published>2017-08-23T10:40:43.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span> <span class="comment">&lt;!-- 使用 HTML5 doctype，不区分大小写 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cmn-Hans"</span>&gt;</span> <span class="comment">&lt;!-- 更加标准的 lang 属性写法 http://zhi.hu/XyIa --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 声明文档使用的字符编码 --&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">'utf-8'</span>&gt;</span></div><div class="line">     </div><div class="line">    <span class="comment">&lt;!-- 优先使用 IE 最新版本和 Chrome --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge,chrome=1"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 页面描述 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"不超过150个字符"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 页面关键词 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">""</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 网页作者 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"author"</span> <span class="attr">content</span>=<span class="string">"name, email@gmail.com"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 搜索引擎抓取 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"robots"</span> <span class="attr">content</span>=<span class="string">"index,follow"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 为移动设备添加 viewport --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- `width=device-width` 会导致 iPhone 5 添加到主屏后以 WebApp 全屏模式打开页面时出现黑边 http://bigc.at/ios-webapp-viewport-meta.orz --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- iOS 设备 begin --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"apple-mobile-web-app-title"</span> <span class="attr">content</span>=<span class="string">"标题"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 添加到主屏后的标题（iOS 6 新增） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"apple-mobile-web-app-capable"</span> <span class="attr">content</span>=<span class="string">"yes"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 是否启用 WebApp 全屏模式，删除苹果默认的工具栏和菜单栏 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"apple-itunes-app"</span> <span class="attr">content</span>=<span class="string">"app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 添加智能 App 广告条 Smart App Banner（iOS 6+ Safari） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"apple-mobile-web-app-status-bar-style"</span> <span class="attr">content</span>=<span class="string">"black"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 设置苹果工具栏颜色 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"format-detection"</span> <span class="attr">content</span>=<span class="string">"telphone=no, email=no"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 忽略页面中的数字识别为电话，忽略email识别 --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 启用360浏览器的极速模式(webkit) --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 避免IE使用兼容模式 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 不让百度转码 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Cache-Control"</span> <span class="attr">content</span>=<span class="string">"no-siteapp"</span> /&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 针对手持设备优化，主要是针对一些老的不识别viewport的浏览器，比如黑莓 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"HandheldFriendly"</span> <span class="attr">content</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 微软的老式浏览器 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"MobileOptimized"</span> <span class="attr">content</span>=<span class="string">"320"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- uc强制竖屏 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"screen-orientation"</span> <span class="attr">content</span>=<span class="string">"portrait"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- QQ强制竖屏 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"x5-orientation"</span> <span class="attr">content</span>=<span class="string">"portrait"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- UC强制全屏 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"full-screen"</span> <span class="attr">content</span>=<span class="string">"yes"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- QQ强制全屏 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"x5-fullscreen"</span> <span class="attr">content</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- UC应用模式 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"browsermode"</span> <span class="attr">content</span>=<span class="string">"application"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- QQ应用模式 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"x5-page-mode"</span> <span class="attr">content</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- windows phone 点击无高光 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"msapplication-tap-highlight"</span> <span class="attr">content</span>=<span class="string">"no"</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iOS 图标 begin --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-icon-precomposed"</span> <span class="attr">href</span>=<span class="string">"/apple-touch-icon-57x57-precomposed.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPhone 和 iTouch，默认 57x57 像素，必须有 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-icon-precomposed"</span> <span class="attr">sizes</span>=<span class="string">"114x114"</span> <span class="attr">href</span>=<span class="string">"/apple-touch-icon-114x114-precomposed.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- Retina iPhone 和 Retina iTouch，114x114 像素，可以没有，但推荐有 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-icon-precomposed"</span> <span class="attr">sizes</span>=<span class="string">"144x144"</span> <span class="attr">href</span>=<span class="string">"/apple-touch-icon-144x144-precomposed.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- Retina iPad，144x144 像素，可以没有，但推荐有 --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- iOS 图标 end --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- iOS 启动画面 begin --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-startup-image"</span> <span class="attr">sizes</span>=<span class="string">"768x1004"</span> <span class="attr">href</span>=<span class="string">"/splash-screen-768x1004.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPad 竖屏 768 x 1004（标准分辨率） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-startup-image"</span> <span class="attr">sizes</span>=<span class="string">"1536x2008"</span> <span class="attr">href</span>=<span class="string">"/splash-screen-1536x2008.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPad 竖屏 1536x2008（Retina） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-startup-image"</span> <span class="attr">sizes</span>=<span class="string">"1024x748"</span> <span class="attr">href</span>=<span class="string">"/Default-Portrait-1024x748.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPad 横屏 1024x748（标准分辨率） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-startup-image"</span> <span class="attr">sizes</span>=<span class="string">"2048x1496"</span> <span class="attr">href</span>=<span class="string">"/splash-screen-2048x1496.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPad 横屏 2048x1496（Retina） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-startup-image"</span> <span class="attr">href</span>=<span class="string">"/splash-screen-320x480.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPhone/iPod Touch 竖屏 320x480 (标准分辨率) --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-startup-image"</span> <span class="attr">sizes</span>=<span class="string">"640x960"</span> <span class="attr">href</span>=<span class="string">"/splash-screen-640x960.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPhone/iPod Touch 竖屏 640x960 (Retina) --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-startup-image"</span> <span class="attr">sizes</span>=<span class="string">"640x1136"</span> <span class="attr">href</span>=<span class="string">"/splash-screen-640x1136.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- iPhone 5/iPod Touch 5 竖屏 640x1136 (Retina) --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- iOS 启动画面 end --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- iOS 设备 end --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"msapplication-TileColor"</span> <span class="attr">content</span>=<span class="string">"#000"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- Windows 8 磁贴颜色 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"msapplication-TileImage"</span> <span class="attr">content</span>=<span class="string">"icon.png"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- Windows 8 磁贴图标 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"alternate"</span> <span class="attr">type</span>=<span class="string">"application/rss+xml"</span> <span class="attr">title</span>=<span class="string">"RSS"</span> <span class="attr">href</span>=<span class="string">"/rss.xml"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 添加 RSS 订阅 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"shortcut icon"</span> <span class="attr">type</span>=<span class="string">"image/ico"</span> <span class="attr">href</span>=<span class="string">"/favicon.ico"</span>/&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 添加 favicon icon --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- sns 社交标签 begin --&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 参考微博API --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">property</span>=<span class="string">"og:type"</span> <span class="attr">content</span>=<span class="string">"类型"</span> /&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">property</span>=<span class="string">"og:url"</span> <span class="attr">content</span>=<span class="string">"URL地址"</span> /&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">property</span>=<span class="string">"og:title"</span> <span class="attr">content</span>=<span class="string">"标题"</span> /&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">property</span>=<span class="string">"og:image"</span> <span class="attr">content</span>=<span class="string">"图片"</span> /&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">property</span>=<span class="string">"og:description"</span> <span class="attr">content</span>=<span class="string">"描述"</span> /&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- sns 社交标签 end --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="移动端" scheme="http://blog.poetries.top/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>ES6笔记记录</title>
    <link href="http://blog.poetries.top/2017/08/20/es6-note-record/"/>
    <id>http://blog.poetries.top/2017/08/20/es6-note-record/</id>
    <published>2017-08-20T06:33:00.000Z</published>
    <updated>2017-10-15T13:34:11.932Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7xq6al.com1.z0.glb.clouddn.com/ES1.png" alt=""></p><p><img src="http://7xq6al.com1.z0.glb.clouddn.com/ES2.png" alt=""></p><p><img src="http://7xq6al.com1.z0.glb.clouddn.com/ES3.png" alt=""></p><p><img src="http://7xq6al.com1.z0.glb.clouddn.com/ES4.png" alt=""></p><p><img src="http://7xq6al.com1.z0.glb.clouddn.com/ES5.png" alt=""></p><p><img src="http://7xq6al.com1.z0.glb.clouddn.com/ES6.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://7xq6al.com1.z0.glb.clouddn.com/ES1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xq6al.com1.z0.glb.clouddn.com/ES2.png&quot; alt=&quot;&quot;&gt;&lt;
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="ES6" scheme="http://blog.poetries.top/tags/ES6/"/>
    
  </entry>
  
  <entry>
    <title>Git笔记总结篇</title>
    <link href="http://blog.poetries.top/2017/07/29/git-notes/"/>
    <id>http://blog.poetries.top/2017/07/29/git-notes/</id>
    <published>2017-07-29T13:30:24.000Z</published>
    <updated>2017-10-15T13:34:11.936Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>声明：资料来源互联网</p></blockquote><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><hr><ul><li><p>在 Windows 上安装 Git 同样轻松，有个叫做 msysGit 的项目提供了安装包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://msysgit.github.io/</div></pre></td></tr></table></figure></li><li><p>完成安装之后，就可以使用命令行的 git 工具（已经自带了 ssh 客户端）了，另外还有一个图形界面的 Git 项目管理工具。</p></li></ul><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><hr><ul><li>首先是配置帐号信息</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git config -e [--global] # 编辑Git配置文件</div><div class="line">git config --global user.name yanhaijing</div><div class="line">git config --global user.email yanhaijing@yeah.net</div><div class="line">git config --list #查看配置的信息</div><div class="line">git help config #获取帮助信息</div></pre></td></tr></table></figure><ul><li>配置自动换行（自动转换坑太大）</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config --global core.autocrlf input #提交到git是自动将换行符转换为lf</div></pre></td></tr></table></figure><ul><li>配置密钥</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -C yanhaijing@yeah.net #生成密钥</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh -T git@github.com #测试是否成功</div></pre></td></tr></table></figure><ul><li>配置别名，git的命令没有自动完成功能，有点坑哈，别名派上了用场</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git config --global alias.st status #git st</div><div class="line">git config --global alias.co checkout #git co</div><div class="line">git config --global alias.br branch #git br</div><div class="line">git config --global alias.ci commit #git ci</div></pre></td></tr></table></figure><h3 id="新建仓库"><a href="#新建仓库" class="headerlink" title="新建仓库"></a>新建仓库</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git init #初始化</div><div class="line">git status #获取状态</div><div class="line">git add [file1] [file2] ... #.或*代表全部添加</div><div class="line">git commit -m &quot;message&quot; #此处注意乱码</div><div class="line">git remote add origin git@github.com:yanhaijing/test.git #添加源</div><div class="line">git push -u origin master #push同事设置默认跟踪分支</div></pre></td></tr></table></figure><h3 id="从现有仓库克隆"><a href="#从现有仓库克隆" class="headerlink" title="从现有仓库克隆"></a>从现有仓库克隆</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git clone git://github.com/yanhaijing/data.js.git    </div><div class="line">git clone git://github.com/schacon/grit.git mypro#克隆到自定义文件夹</div></pre></td></tr></table></figure><h3 id="本地"><a href="#本地" class="headerlink" title="本地"></a>本地</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">git add * # 跟踪新文件</div><div class="line">git add -u [path] # 添加[指定路径下]已跟踪文件</div><div class="line"></div><div class="line">rm *&amp;git rm * # 移除文件</div><div class="line">git rm -f * # 移除文件</div><div class="line">git rm --cached * # 停止追踪指定文件，但该文件会保留在工作区</div><div class="line">git mv file_from file_to # 重命名跟踪文件</div><div class="line"></div><div class="line">git log # 查看提交记录</div><div class="line"></div><div class="line">git commit # 提交更新    </div><div class="line">git commit [file1] [file2] ... # 提交指定文件    </div><div class="line">git commit -m &apos;message&apos;</div><div class="line">git commit -a # 跳过使用暂存区域，把所有已经跟踪过的文件暂存起来一并提交</div><div class="line">git commit --amend#修改最后一次提交</div><div class="line">git commit -v # 提交时显示所有diff信息</div><div class="line"></div><div class="line">git reset HEAD *#取消已经暂存的文件</div><div class="line">git reset --mixed HEAD *#同上</div><div class="line">git reset --soft HEAD *#重置到指定状态，不会修改索引区和工作树</div><div class="line">git reset --hard HEAD *#重置到指定状态，会修改索引区和工作树</div><div class="line">git reset -- files#重置index区文件</div><div class="line"></div><div class="line">git revert HEAD #撤销前一次操作</div><div class="line">git revert HEAD~ #撤销前前一次操作</div><div class="line">git revert commit ## 撤销指定操作</div><div class="line"></div><div class="line">git checkout -- file#取消对文件的修改（从暂存区——覆盖worktree file）</div><div class="line">git checkout branch|tag|commit -- file_name#从仓库取出file覆盖当前分支</div><div class="line">git checkout -- .#从暂存区取出文件覆盖工作区</div><div class="line"></div><div class="line">git diff file #查看指定文件的差异</div><div class="line">git diff --stat #查看简单的diff结果</div><div class="line">git diff #比较Worktree和Index之间的差异</div><div class="line">git diff --cached #比较Index和HEAD之间的差异</div><div class="line">git diff HEAD #比较Worktree和HEAD之间的差异</div><div class="line">git diff branch #比较Worktree和branch之间的差异</div><div class="line">git diff branch1 branch2 #比较两次分支之间的差异</div><div class="line">git diff commit commit #比较两次提交之间的差异</div><div class="line"></div><div class="line">git log #查看最近的提交日志</div><div class="line">git log --pretty=oneline #单行显示提交日志</div><div class="line">git log --graph # 图形化显示</div><div class="line">git log --abbrev-commit # 显示log id的缩写</div><div class="line">git log -num #显示第几条log（倒数）</div><div class="line">git log --stat # 显示commit历史，以及每次commit发生变更的文件</div><div class="line">git log --follow [file] # 显示某个文件的版本历史，包括文件改名</div><div class="line">git log -p [file] # 显示指定文件相关的每一次diff</div><div class="line"></div><div class="line">git stash #将工作区现场（已跟踪文件）储藏起来，等以后恢复后继续工作。</div><div class="line">git stash list #查看保存的工作现场</div><div class="line">git stash apply #恢复工作现场</div><div class="line">git stash drop #删除stash内容</div><div class="line">git stash pop #恢复的同时直接删除stash内容</div><div class="line">git stash apply stash@&#123;0&#125; #恢复指定的工作现场，当你保存了不只一份工作现场时。</div></pre></td></tr></table></figure><h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">git branch#列出本地分支</div><div class="line">git branch -r#列出远端分支</div><div class="line">git branch -a#列出所有分支</div><div class="line">git branch -v#查看各个分支最后一个提交对象的信息</div><div class="line">git branch --merge#查看已经合并到当前分支的分支</div><div class="line">git branch --no-merge#查看为合并到当前分支的分支</div><div class="line">git branch test#新建test分支</div><div class="line">git branch branch [branch|commit|tag] # 从指定位置出新建分支</div><div class="line">git branch --track branch remote-branch # 新建一个分支，与指定的远程分支建立追踪关系</div><div class="line">git branch -m old new #重命名分支</div><div class="line">git branch -d test#删除test分支</div><div class="line">git branch -D test#强制删除test分支</div><div class="line">git branch --set-upstream dev origin/dev #将本地dev分支与远程dev分支之间建立链接</div><div class="line"></div><div class="line">git checkout test#切换到test分支</div><div class="line">git checkout -b test#新建+切换到test分支</div><div class="line">git checkout -b test dev#基于dev新建test分支，并切换</div><div class="line"></div><div class="line">git merge test#将test分支合并到当前分支</div><div class="line">git merge --squash test ## 合并压缩，将test上的commit压缩为一条</div><div class="line"></div><div class="line">git cherry-pick commit #拣选合并，将commit合并到当前分支</div><div class="line">git cherry-pick -n commit #拣选多个提交，合并完后可以继续拣选下一个提交</div><div class="line"></div><div class="line">git rebase master#将master分之上超前的提交，变基到当前分支</div><div class="line">git rebase --onto master 169a6 #限制回滚范围，rebase当前分支从169a6以后的提交</div><div class="line">git rebase --interactive #交互模式    </div><div class="line">git rebase --continue# 处理完冲突继续合并    </div><div class="line">git rebase --skip# 跳过    </div><div class="line">git rebase --abort# 取消合并</div></pre></td></tr></table></figure><h3 id="远端"><a href="#远端" class="headerlink" title="远端"></a>远端</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">git fetch origin remotebranch[:localbranch]# 从远端拉去分支[到本地指定分支]</div><div class="line"></div><div class="line">git merge origin/branch#合并远端上指定分支</div><div class="line"></div><div class="line">git pull origin remotebranch:localbranch# 拉去远端分支到本地分支</div><div class="line"></div><div class="line">git push origin branch#将当前分支，推送到远端上指定分支</div><div class="line">git push origin localbranch:remotebranch#推送本地指定分支，到远端上指定分支</div><div class="line">git push origin :remotebranch # 删除远端指定分支</div><div class="line">git push origin remotebranch --delete # 删除远程分支</div><div class="line">git branch -dr branch # 删除本地和远程分支</div><div class="line">git checkout -b [--track] test origin/dev#基于远端dev分支，新建本地test分支[同时设置跟踪]</div></pre></td></tr></table></figure><h3 id="源"><a href="#源" class="headerlink" title="源"></a>源</h3><hr><blockquote><p>git是一个分布式代码管理工具，所以可以支持多个仓库，在git里，服务器上的仓库在本地称之为remote。</p></blockquote><ul><li>个人开发时，多源用的可能不多，但多源其实非常有用。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">git remote add origin1 git@github.com:yanhaijing/data.js.git</div><div class="line"></div><div class="line">git remote#显示全部源</div><div class="line">git remote -v#显示全部源+详细信息</div><div class="line"></div><div class="line">git remote rename origin1 origin2#重命名</div><div class="line"></div><div class="line">git remote rm origin#删除</div><div class="line"></div><div class="line">git remote show origin#查看指定源的全部信息</div></pre></td></tr></table></figure><h3 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h3><hr><blockquote><p>当开发到一定阶段时，给程序打标签是非常棒的功能。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">git tag#列出现有标签    </div><div class="line"></div><div class="line">git tag v0.1 [branch|commit] # [从指定位置]新建标签</div><div class="line">git tag -a v0.1 -m &apos;my version 1.4&apos;#新建带注释标签</div><div class="line"></div><div class="line">git checkout tagname#切换到标签</div><div class="line"></div><div class="line">git push origin v1.5#推送分支到源上</div><div class="line">git push origin --tags#一次性推送所有分支</div><div class="line"></div><div class="line">git tag -d v0.1#删除标签</div><div class="line">git push origin :refs/tags/v0.1#删除远程标签</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;声明：资料来源互联网&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;headerlink&quot; title=&quot;安装&quot;&gt;&lt;/a&gt;安装&lt;/h3&gt;&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在 Windows 上
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="Git" scheme="http://blog.poetries.top/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>Visual Studio Code 常用快捷键</title>
    <link href="http://blog.poetries.top/2017/07/23/vs-keyboard-shortcuts/"/>
    <id>http://blog.poetries.top/2017/07/23/vs-keyboard-shortcuts/</id>
    <published>2017-07-23T11:40:03.000Z</published>
    <updated>2017-10-15T13:34:11.960Z</updated>
    
    <content type="html"><![CDATA[<h3 id="主命令框"><a href="#主命令框" class="headerlink" title="主命令框"></a>主命令框</h3><blockquote><p><code>F1</code> 或 <code>Ctrl+Shift+P</code>: 打开命令面板。在打开的输入框内，可以输入任何命令</p><ul><li>按一下 <code>Backspace</code>会进入到 <code>Ctrl+P</code>模式<br>在 </li><li><code>Ctrl+P</code> 下输入 &gt; 可以进入 <code>Ctrl+Shift+P</code> 模式</li></ul></blockquote><p><strong>在 <code>Ctrl+P</code> 窗口下还可以</strong></p><ul><li>直接输入文件名，跳转到文件</li><li><code>?</code> 列出当前可执行的动作</li><li>! 显示 <code>Errors</code>或 <code>Warnings</code>，也可以 <code>Ctrl+Shift+M</code></li><li>: 跳转到行数，也可以 <code>Ctrl+G</code> 直接进入</li><li>@ 跳转到 <code>symbol</code>（搜索变量或者函数），也可以 <code>Ctrl+Shift+O</code>直接进入</li><li>@ 根据分类跳转 - <code>symbol</code>，查找属性或函数，也可以 <code>Ctrl+Shift+O</code>后输入:进入</li><li>#根据名字查找 <code>symbol</code>，也可以 <code>Ctrl+T</code></li></ul><h3 id="编辑器与窗口管理"><a href="#编辑器与窗口管理" class="headerlink" title="编辑器与窗口管理"></a>编辑器与窗口管理</h3><ul><li>打开一个新窗口： <code>Ctrl+Shift+N</code></li><li>关闭窗口： <code>Ctrl+Shift+W</code></li><li>新建文件 <code>Ctrl+N</code></li><li>文件之间切换 <code>Ctrl+Tab</code></li></ul><h3 id="代码编辑"><a href="#代码编辑" class="headerlink" title="代码编辑"></a>代码编辑</h3><h4 id="格式调整"><a href="#格式调整" class="headerlink" title="格式调整"></a>格式调整</h4><ul><li>代码行缩进 <code>Ctrl+[</code> 、 <code>Ctrl+]</code></li><li><code>Ctrl+C</code>、 <code>Ctrl+V</code> 复制或剪切当前行/当前选中内容</li><li>代码格式化： <code>Ctrl+Shift+P</code> 后输入 <code>format code</code></li><li>上下移动一行：<code>Alt+Up</code>或 <code>Alt+Down</code></li><li>向上向下复制一行： <code>Shift+Alt+Up</code>或 <code>Shift+Alt+Down</code></li><li>在当前行下边插入一行 <code>Ctrl+Enter</code></li><li>在当前行上方插入一行 <code>Ctrl+Shift+Enter</code></li></ul><h4 id="光标相关"><a href="#光标相关" class="headerlink" title="光标相关"></a>光标相关</h4><ul><li>移动到行首： <code>Home</code></li><li>移动到行尾： <code>End</code></li><li>移动到文件结尾： <code>Ctrl+End</code></li><li>移动到文件开头： <code>Ctrl+Home</code></li><li>移动到定义处： <code>F12</code></li><li>多行编辑(列编辑)：<code>Alt+Shift+</code>鼠标左键</li><li>同时选中所有匹配： <code>Ctrl+Shift+L</code></li></ul><h3 id="重构代码"><a href="#重构代码" class="headerlink" title="重构代码"></a>重构代码</h3><ul><li>找到所有的引用： <code>Shift+F12</code></li><li>同时修改本文件中所有匹配的： <code>Ctrl+F12</code></li><li>重命名：比如要修改一个方法名，可以选中后按 <code>F2</code>，输入新的名字，回车，会发现所有的文件都修改了</li><li>跳转到下一个 <code>Error</code> 或 <code>Warning</code>：当有多个错误时可以按 <code>F8</code> 逐个跳转</li></ul><h3 id="查找替换"><a href="#查找替换" class="headerlink" title="查找替换"></a>查找替换</h3><ul><li>查找 <code>Ctrl+F</code></li><li>查找替换 <code>Ctrl+H</code></li><li>整个文件夹中查找 <code>Ctrl+Shift+F</code></li></ul><h3 id="显示相关"><a href="#显示相关" class="headerlink" title="显示相关"></a>显示相关</h3><ul><li>全屏：<code>F11</code></li><li>侧边栏显/隐：<code>Ctrl+B</code></li><li>显示资源管理器 <code>Ctrl+Shift+E</code></li><li>显示搜索 <code>Ctrl+Shift+F</code></li><li>显示 <code>Debug Ctrl+Shift+D</code></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;主命令框&quot;&gt;&lt;a href=&quot;#主命令框&quot; class=&quot;headerlink&quot; title=&quot;主命令框&quot;&gt;&lt;/a&gt;主命令框&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;F1&lt;/code&gt; 或 &lt;code&gt;Ctrl+Shift+P&lt;/code&gt;: 打开命令
      
    
    </summary>
    
      <category term="工欲善其事必先利其器" scheme="http://blog.poetries.top/categories/%E5%B7%A5%E6%AC%B2%E5%96%84%E5%85%B6%E4%BA%8B%E5%BF%85%E5%85%88%E5%88%A9%E5%85%B6%E5%99%A8/"/>
    
    
      <category term="VS" scheme="http://blog.poetries.top/tags/VS/"/>
    
  </entry>
  
  <entry>
    <title>移动端适配</title>
    <link href="http://blog.poetries.top/2017/05/23/mobile-adaptation/"/>
    <id>http://blog.poetries.top/2017/05/23/mobile-adaptation/</id>
    <published>2017-05-23T13:35:08.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<ul><li>物理像素:移动端设备的分辨率</li><li>独立像素:css的像素  320  375 </li><li>像素比 = 物理像素/独立像素</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0&quot;&gt;</div></pre></td></tr></table></figure><ul><li><p><code>width=device-width</code>  设备宽度 <code>640px</code>(低版本的安卓手机不支持数字) 这个属性在不支持<code>IE</code></p></li><li><p><code>initial-scale=1.0</code>(初始缩放比),能够起到和<code>width=device-width</code>相同的效果(把理想的视窗设置为设备的宽度)     两个配合使用就能够很好的解决移动端各设备的适配问题</p></li><li><p><code>maximum-scale=1.0</code>最大缩放比例</p></li><li><code>user-scalable=0</code>禁止缩放</li><li><code>minimum-scale=1.0</code> 最小缩放比例</li></ul><h3 id="移动端布局方法"><a href="#移动端布局方法" class="headerlink" title="移动端布局方法"></a>移动端布局方法</h3><hr><ul><li><p>1、流式布局  与设备等宽 做自适应  100%或者具体的像素值</p></li><li><p>2、<code>rem</code>做盒子的宽度，viewport缩放</p></li><li><p>3、固定宽度  <code>viewport</code>缩放  <code>content=&quot;width=640, initial-scale=0.5, maximum-scale=0.5, user-scalable=0&quot;</code>（用的比较少）</p></li><li><p>4、<code>vw/vh</code> 相对于viewport理想视窗(设备)的比例(兼容性不好)<br>  <code>1vw = 10%</code>设备宽 <code>10vw</code></p></li></ul><h3 id="meta标签属性设置"><a href="#meta标签属性设置" class="headerlink" title="meta标签属性设置"></a>meta标签属性设置</h3><hr><p><code>&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge chrome=1&quot;&gt;</code></p><ul><li>IE8<code>浏览器的显示方式:</code>IE=edge<code>以</code>IE`最高版本显示</li><li>chrome=1 以谷歌浏览器模式渲染(GCF(Google Chrome Frame))</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;</div></pre></td></tr></table></figure><ul><li>referrer 告诉浏览器链接来源于哪里(计算网页上链接的访问量)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;format-detection&quot; content=&quot;telephone=no,email=no,adress=no&quot;&gt;</div></pre></td></tr></table></figure><ul><li>格式检测:（数字、邮箱、地址） no不识别为电话号码、邮箱、地址</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;</div></pre></td></tr></table></figure><ul><li>删除默认的苹果工具栏、菜单栏(全屏显示)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;apple-touch-fullscreen&quot; =&quot;yes&quot;&gt;</div></pre></td></tr></table></figure><ul><li>全屏显示</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;black&quot;&gt;</div></pre></td></tr></table></figure><ul><li>设置app应用下状态条的颜色</li><li>默认值default (白色)  black（黑色）</li><li><code>black-translucent</code>（灰色半透明）若果设置为这个值会占据页面的<code>px</code>位置浮在页面上方<code>20px</code>高度 <code>iphone4</code>是<code>40px</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;renderer&quot; content=&quot;webkit&quot;&gt;</div></pre></td></tr></table></figure><ul><li><code>360</code>模式固定为极速模式</li></ul><h3 id="常见的meta属性"><a href="#常见的meta属性" class="headerlink" title="常见的meta属性"></a>常见的meta属性</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;format-detection&quot; content=&quot;telephone=no&quot;&gt;</div><div class="line">&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;</div><div class="line">&lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;black&quot;&gt;</div><div class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0，minimum-scale=1.0&quot;&gt;</div></pre></td></tr></table></figure><h3 id="link-扩展"><a href="#link-扩展" class="headerlink" title="link 扩展"></a>link 扩展</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;xxx.com&quot;&gt;</div></pre></td></tr></table></figure><blockquote><p> 预解析技术，当浏览网页时，浏览器会在加载页面的时对页面中的域名进行解析缓存，当我们点击这些网页的链接时就不需要再进行DNS的解析，减少用户的等待时间，提高用户的体验度</p></blockquote><ul><li><code>rem</code>  根目录 <code>html</code> 的<code>font-size</code>尺寸默认为<code>16px</code>  <code>1rem = 16px;</code></li><li><code>1rem = html</code>的<code>font-size</code>的尺寸大小</li></ul><h3 id="参考学习资料"><a href="#参考学习资料" class="headerlink" title="参考学习资料"></a>参考学习资料</h3><hr><ul><li><a href="https://h5.m.taobao.com/#index" target="_blank" rel="external">https://h5.m.taobao.com/#index</a> 手机淘宝 rem</li><li><a href="http://m.jd.com/" target="_blank" rel="external">http://m.jd.com/</a>  手机京东 100%</li><li><a href="http://m.lizhi.fm/" target="_blank" rel="external">http://m.lizhi.fm/</a> 荔枝 640视窗</li><li><a href="http://jx.tmall.com/" target="_blank" rel="external">http://jx.tmall.com/</a> 天猫 100%</li><li><a href="http://3g.163.com/touch/all?nav=1&amp;version=v_standard" target="_blank" rel="external">http://3g.163.com/touch/all?nav=1&amp;version=v_standard</a>   网易 rem</li></ul><ul><li><a href="http://www.cnblogs.com/2050/p/3877280.html" target="_blank" rel="external">http://www.cnblogs.com/2050/p/3877280.html</a>  viewport 解析</li><li><a href="http://ymblog.net/2015/07/01/%E7%A7%BB%E5%8A%A8%E5%89%8D%E7%AB%AFmeta%E6%A0%87%E7%AD%BE%E8%BD%AC/" target="_blank" rel="external">http://ymblog.net/2015/07/01/%E7%A7%BB%E5%8A%A8%E5%89%8D%E7%AB%AFmeta%E6%A0%87%E7%AD%BE%E8%BD%AC/</a>  meta解析</li><li><a href="http://ljinkai.github.io/2015/06/06/mobile-web-skill/" target="_blank" rel="external">http://ljinkai.github.io/2015/06/06/mobile-web-skill/</a>  移动端布局注意技巧</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;物理像素:移动端设备的分辨率&lt;/li&gt;
&lt;li&gt;独立像素:css的像素  320  375 &lt;/li&gt;
&lt;li&gt;像素比 = 物理像素/独立像素&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="HTML5" scheme="http://blog.poetries.top/tags/HTML5/"/>
    
      <category term="移动端" scheme="http://blog.poetries.top/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>forever and pm2部署nodejs项目</title>
    <link href="http://blog.poetries.top/2017/05/09/forever-pm2/"/>
    <id>http://blog.poetries.top/2017/05/09/forever-pm2/</id>
    <published>2017-05-09T14:50:08.000Z</published>
    <updated>2017-10-15T13:34:11.932Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、forever"><a href="#一、forever" class="headerlink" title="一、forever"></a>一、forever</h2><blockquote><p><code>forever</code>则可以在<code>cmd</code>或<code>ssh</code>连接断开时,让项目一直运行,而且可以在项目崩溃时自动重启</p></blockquote><ul><li>安装 <code>npm install -g forever</code></li><li><code>forever</code>的帮助手册  <code>forever --help</code></li><li>使用<code>forever</code>启动项目 <code>forever start app.js</code></li><li>使用<code>forever</code>停止项目 <code>forever stop app.js</code></li><li>列出所有通过<code>forever</code>管理的项目 <code>forever list</code></li><li>监视项目中的文件,当文件有变动时重启项目 <code>forever -w start app.js</code></li></ul><h2 id="二、pm2"><a href="#二、pm2" class="headerlink" title="二、pm2"></a>二、pm2</h2><ul><li>安装pm2 <code>npm install -g pm2</code></li><li>运行<code>pm2 start app.js</code></li><li>查看运行状态 <code>pm2 list</code></li><li>追踪资源运行情况 <code>pm2 monit</code></li><li>查看日志 <code>pm2 logs</code></li><li>重启应用 <code>pm2 restart appId</code></li><li>停止应用  <code>pm2 stop app.js</code></li><li>开启<code>api</code>访问 <code>pm2 web</code></li></ul><p><strong>预定义运行配置文件</strong></p><blockquote><p>我们可以预定义一个配置文件，然后制定运行这个配置文件，比如我们定义一个文件<code>process.json</code>，内容如下</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;apps&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;name&quot;: &quot;ANodeBlog&quot;,</div><div class="line">      &quot;script&quot;: &quot;bin/www&quot;,</div><div class="line">      &quot;watch&quot;: &quot;../&quot;,</div><div class="line">      &quot;log_date_format&quot;: &quot;YYYY-MM-DD HH:mm Z&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>然后<code>pm2 start process.json</code></li></ul><p><strong>pm2与forever对比</strong></p><table><thead><tr><th>Feature</th><th>Forever</th><th>PM2</th></tr></thead><tbody><tr><td>Keep Alive</td><td>✔</td><td>✔</td></tr><tr><td>Coffeescript</td><td>✔</td><td></td></tr><tr><td>Log aggregation</td><td></td><td>✔</td></tr><tr><td>API</td><td></td><td>✔</td></tr><tr><td>Terminal monitoring</td><td></td><td>✔</td></tr><tr><td>Clustering</td><td></td><td>✔</td></tr><tr><td>JSON configuration</td><td></td><td>✔</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;一、forever&quot;&gt;&lt;a href=&quot;#一、forever&quot; class=&quot;headerlink&quot; title=&quot;一、forever&quot;&gt;&lt;/a&gt;一、forever&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;forever&lt;/code&gt;则可以在&lt;code
      
    
    </summary>
    
      <category term="Back-end" scheme="http://blog.poetries.top/categories/Back-end/"/>
    
    
      <category term="Node" scheme="http://blog.poetries.top/tags/Node/"/>
    
      <category term="部署" scheme="http://blog.poetries.top/tags/%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>Nginx基础配置篇</title>
    <link href="http://blog.poetries.top/2017/05/08/nginx/"/>
    <id>http://blog.poetries.top/2017/05/08/nginx/</id>
    <published>2017-05-08T14:35:08.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Nginx的启动、停止与重启"><a href="#Nginx的启动、停止与重启" class="headerlink" title="Nginx的启动、停止与重启"></a>Nginx的启动、停止与重启</h3><ul><li>建立软连接<code>Nginx</code>到<code>/usr/bin</code>目录下 <code>ln -s /usr/sbin/nginx /usr/bin</code></li></ul><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><ul><li>启动代码格式：<code>nginx</code>安装目录地址 <code>-c nginx</code>配置文件地址</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@LinuxServer sbin]# /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</div></pre></td></tr></table></figure><h4 id="停止"><a href="#停止" class="headerlink" title="停止"></a>停止</h4><blockquote><p> nginx的停止有三种方式</p></blockquote><p><strong>从容停止</strong></p><ul><li>查看进程号 <code>ps -ef|grep nginx</code></li></ul><p><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102182744854-1291053517.png" alt=""></p><ul><li>杀死进程 kill -QUIT 2072</li></ul><p><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102182652354-960281274.png" alt=""></p><p><strong>快速停止</strong></p><ul><li>查看进程号 <code>ps -ef|grep nginx</code></li></ul><p><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102183103651-1859453208.png" alt=""></p><ul><li>杀死进程 <code>kill -TERM 2132</code>  <code>kill -INT 2132</code></li></ul><p><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102183340010-2024212451.png" alt=""></p><ul><li>强制停止 <code>pkill -9 nginx</code></li></ul><p><strong>重启</strong></p><blockquote><p>验证<code>nginx</code>配置文件是否正确</p></blockquote><ul><li>方法一：进入<code>nginx</code>安装目录<code>sbin</code>下，输入命令<code>./nginx -t</code><br>看到如下显示<code>nginx.conf syntax is ok nginx.conf test is successful</code>说明配置文件正确</li></ul><p><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102184633432-1268782338.png" alt=""></p><ul><li>方法二：在启动命令<code>-c</code>前加<code>-t</code></li></ul><p><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102185023385-456612180.png" alt=""></p><p><strong>重启Nginx服务</strong></p><ul><li>方法一：进入<code>nginx</code>可执行目录<code>sbin</code>下，输入命令<code>./nginx -s reload</code>即可</li></ul><p><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102185521057-1341380905.png" alt=""></p><ul><li>方法二：查找当前<code>nginx</code>进程号，然后输入命令：<code>kill -HUP</code> 进程号 实现重启<code>nginx</code>服务<br><img src="http://images2015.cnblogs.com/blog/848552/201601/848552-20160102185838167-234856506.png" alt=""></li></ul><h3 id="Nginx基础配置"><a href="#Nginx基础配置" class="headerlink" title="Nginx基础配置"></a>Nginx基础配置</h3><ul><li>在<code>Nginx</code>目录下的<code>vhost或conf.d</code>目录下新建一个配置文件（如<code>poetries-80.conf</code>）</li><li>把server的内容配置进去</li><li>在<code>Nginx.conf</code>中的<code>http</code>下<code>include</code>配置文件</li><li>检测配置文件是否出错 <code>切换到/etc/nginx下 nginx -t</code></li><li>重新加载配置文件 <code>nginx -c /usr/local/etc/nginx/nginx.conf</code></li><li>在重启<code>Nginx</code>  <code>nginx -s reload</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">user  root;  <span class="comment">//Nginx需要有有一个用户</span></div><div class="line">worker_processes  <span class="number">2</span>; <span class="comment">// Nginx进程数 最大1024</span></div><div class="line">pid        conf/nginx.pid; </div><div class="line">worker_rlimit_nofile <span class="number">2048</span>;</div><div class="line">events &#123;</div><div class="line">    use epoll;</div><div class="line">    worker_connections  <span class="number">2048</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">http &#123;</div><div class="line"> </div><div class="line"></div><div class="line">server &#123;</div><div class="line">       listen       <span class="number">80</span>;</div><div class="line">       server_name  <span class="number">119.29</span><span class="number">.145</span><span class="number">.252</span>;</div><div class="line">   </div><div class="line">       location / &#123;</div><div class="line">           root   /usr/local/nginx/html;</div><div class="line">           index  index.html index.htm;</div><div class="line">        &#125;</div><div class="line">   &#125;</div><div class="line">   server &#123;</div><div class="line">       listen       <span class="number">3001</span>;</div><div class="line">       server_name  <span class="number">119.29</span><span class="number">.145</span><span class="number">.252</span>;</div><div class="line">   </div><div class="line">       location / &#123;</div><div class="line">           root   /usr/local/nginx/book;</div><div class="line">           index  index.html index.htm;</div><div class="line">        &#125;</div><div class="line">   &#125;</div><div class="line">   server &#123;</div><div class="line">       listen       <span class="number">9000</span>;</div><div class="line">       server_name  <span class="number">119.29</span><span class="number">.145</span><span class="number">.252</span>;</div><div class="line">   </div><div class="line">       location / &#123;</div><div class="line">           root   /usr/local/nginx/vue;</div><div class="line">           index  index.html index.htm;</div><div class="line">        &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="一些错误"><a href="#一些错误" class="headerlink" title="一些错误"></a>一些错误</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nginx: [error] invalid PID number “” <span class="keyword">in</span> “/usr/local/<span class="keyword">var</span>/run/nginx/nginx.pid”</div></pre></td></tr></table></figure><ul><li>解决办法：<code>nginx -c /usr/local/etc/nginx/nginx.conf</code></li><li><code>nginx -s reload</code></li></ul><p><strong>权限问题导致Nginx 403 Forbidden错误的解决方法</strong></p><ul><li>在<code>nginx.conf</code>头部加入一行 <code>user  root;</code></li><li>重启<code>nginx</code>再访问，就可以正常访问了</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Nginx的启动、停止与重启&quot;&gt;&lt;a href=&quot;#Nginx的启动、停止与重启&quot; class=&quot;headerlink&quot; title=&quot;Nginx的启动、停止与重启&quot;&gt;&lt;/a&gt;Nginx的启动、停止与重启&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;建立软连接&lt;code&gt;Nginx
      
    
    </summary>
    
      <category term="Back-end" scheme="http://blog.poetries.top/categories/Back-end/"/>
    
    
      <category term="Nginx" scheme="http://blog.poetries.top/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>python 3.5下xadmin的使用方法</title>
    <link href="http://blog.poetries.top/2017/05/05/python3-xadmin/"/>
    <id>http://blog.poetries.top/2017/05/05/python3-xadmin/</id>
    <published>2017-05-05T03:35:24.000Z</published>
    <updated>2017-10-15T13:34:11.956Z</updated>
    
    <content type="html"><![CDATA[<h3 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h3><ul><li>复制 xadmin 目录到你的项目</li><li><code>pip install httplib2 django-formtools django-crispy-forms</code><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># setting.py</span></div><div class="line">INSTALLED_APPS = [</div><div class="line">    ...,</div><div class="line">    <span class="string">'xadmin'</span>,</div><div class="line">    <span class="string">'crispy_forms'</span>,</div><div class="line">]</div></pre></td></tr></table></figure></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># urls.py</span></div><div class="line"><span class="keyword">import</span> xadmin</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^admin/'</span>, xadmin.site.urls)</div><div class="line">]</div></pre></td></tr></table></figure><h3 id="xadmin-「自带的」BUG-修复方法"><a href="#xadmin-「自带的」BUG-修复方法" class="headerlink" title="xadmin 「自带的」BUG 修复方法"></a>xadmin 「自带的」BUG 修复方法</h3><p>当我们重写了 Django 的 User 表后，xadmin 就会出现 bug。<br>master 分支里，我用 <code>users/models.py</code> 里的 <code>UserProfile</code> 重写了自带的 <code>auth_user</code> 表。<br>这里会出现两个 BUG：</p><ul><li>xadmin 无法管理重写后的User表</li><li>在 xadmin 后台页面点击右上角修改密码时，会报错</li></ul><p><a href="http://www.cnblogs.com/vincenshen/articles/6528344.html" target="_blank" rel="external">点击查看解决办法</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;安装方法&quot;&gt;&lt;a href=&quot;#安装方法&quot; class=&quot;headerlink&quot; title=&quot;安装方法&quot;&gt;&lt;/a&gt;安装方法&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;复制 xadmin 目录到你的项目&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pip install httplib2 dj
      
    
    </summary>
    
      <category term="Back-end" scheme="http://blog.poetries.top/categories/Back-end/"/>
    
    
      <category term="python" scheme="http://blog.poetries.top/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>ES6编码风格</title>
    <link href="http://blog.poetries.top/2017/04/14/es6-coding-style/"/>
    <id>http://blog.poetries.top/2017/04/14/es6-coding-style/</id>
    <published>2017-04-14T06:24:08.000Z</published>
    <updated>2017-10-15T13:34:11.932Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、块级作用域"><a href="#一、块级作用域" class="headerlink" title="一、块级作用域"></a>一、块级作用域</h2><hr><h3 id="1-1-let取代var"><a href="#1-1-let取代var" class="headerlink" title="1.1 let取代var"></a>1.1 let取代var</h3><hr><ul><li><code>ES6</code>提出了两个新的声明变量的命令：<code>let</code>和<code>const</code>。其中，<code>let</code>完全可以取代<code>var</code>，因为两者语义相同，而且<code>let</code>没有副作用</li><li><code>var</code>命令存在变量提升效用，<code>let</code>命令没有这个问题</li><li>建议不再使用<code>var</code>命令，而是使用<code>let</code>命令取代</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">"use strict"</span>;</div><div class="line"><span class="keyword">if</span>(<span class="literal">true</span>) &#123;</div><div class="line"><span class="built_in">console</span>.log(x); <span class="comment">// ReferenceError</span></div><div class="line"><span class="keyword">let</span> x = <span class="string">'hello'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>上面代码如果使用<code>var</code>替代<code>let</code>，<code>console.log</code>那一行就不会报错，而是会输出<code>undefined</code>，因为变量声明提<br>升到代码块的头部。这违反了变量先声明后使用的原则</li></ul><h3 id="1-2-全局常量和线程安全"><a href="#1-2-全局常量和线程安全" class="headerlink" title="1.2 全局常量和线程安全"></a>1.2 全局常量和线程安全</h3><hr><ul><li>在<code>let</code>和<code>const</code>之间，建议优先使用<code>const</code>，尤其是在全局环境，不应该设置变量，只应设置常量。这符合函数式编程思想，有利于将来的分布式运算。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</div><div class="line"><span class="keyword">const</span> b = <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> c = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// best</span></div><div class="line"><span class="keyword">const</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div></pre></td></tr></table></figure><ul><li><code>const</code>声明常量还有两个好处，一是阅读代码的人立刻会意识到不应该修改这个值，二是防止了无意间修改<br>变量值所导致的错误</li><li>所有的函数都应该设置为常量</li><li>let表示的变量，只应出现在单线程运行的代码中，不能是多线程共享的，这样有利于保证线程安全</li></ul><h3 id="1-3-严格模式"><a href="#1-3-严格模式" class="headerlink" title="1.3 严格模式"></a>1.3 严格模式</h3><hr><ul><li><code>V8</code>引擎只在严格模式之下，支持<code>let</code>和<code>const</code>。结合前两点，这实际上意味着，将来所有的编程都是针对严<br>格模式的。</li></ul><h2 id="二、字符串"><a href="#二、字符串" class="headerlink" title="二、字符串"></a>二、字符串</h2><hr><ul><li>静态字符串一律使用单引号，不使用双引号。动态字符串使用反引号</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> a = <span class="string">"foobar"</span>;</div><div class="line"><span class="keyword">const</span> b = <span class="string">'foo'</span> + a + <span class="string">'bar'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = <span class="string">'foobar'</span>;</div><div class="line"><span class="keyword">const</span> b = <span class="string">`foo<span class="subst">$&#123;a&#125;</span>bar`</span>;</div><div class="line"><span class="keyword">const</span> c = <span class="string">'foobar'</span>;</div></pre></td></tr></table></figure><h2 id="三、解构赋值"><a href="#三、解构赋值" class="headerlink" title="三、解构赋值"></a>三、解构赋值</h2><hr><ul><li>使用数组成员对变量赋值，优先使用解构赋值</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> first = arr[<span class="number">0</span>];</div><div class="line"><span class="keyword">const</span> second = arr[<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> [first, second] = arr;</div></pre></td></tr></table></figure><ul><li>函数的参数如果是对象的成员，优先使用解构赋值</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">user</span>) </span>&#123;</div><div class="line"><span class="keyword">const</span> firstName = user.firstName;</div><div class="line"><span class="keyword">const</span> lastName = user.lastName;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line"><span class="keyword">const</span> &#123; firstName, lastName &#125; = obj;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// best</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">&#123; firstName, lastName &#125;</span>) </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>如果函数返回多个值，优先使用对象的解构赋值，而不是数组的解构赋值。这样便于以后添加返回值，以及更改返回值的顺序</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> [left, right, top, bottom];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> &#123; left, right, top, bottom &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> &#123; left, right &#125; = processInput(input);</div></pre></td></tr></table></figure><h2 id="四、对象"><a href="#四、对象" class="headerlink" title="四、对象"></a>四、对象</h2><hr><ul><li>单行定义的对象，最后一个成员不以逗号结尾。多行定义的对象，最后一个成员以逗号结尾</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> a = &#123; <span class="attr">k1</span>: v1, <span class="attr">k2</span>: v2, &#125;;</div><div class="line"><span class="keyword">const</span> b = &#123;</div><div class="line">k1: v1,</div><div class="line">k2: v2</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = &#123; <span class="attr">k1</span>: v1, <span class="attr">k2</span>: v2 &#125;;</div><div class="line"><span class="keyword">const</span> b = &#123;</div><div class="line">k1: v1,</div><div class="line">k2: v2,</div><div class="line">&#125;;</div></pre></td></tr></table></figure><ul><li>对象尽量静态化，一旦定义，就不得随意添加新的属性。如果添加属性不可避免，要使用<code>Object.assign</code>方法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> a = &#123;&#125;;</div><div class="line">a.x = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// if reshape unavoidable</span></div><div class="line"><span class="keyword">const</span> a = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.assign(a, &#123; <span class="attr">x</span>: <span class="number">3</span> &#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = &#123; <span class="attr">x</span>: <span class="literal">null</span> &#125;;</div><div class="line">a.x = <span class="number">3</span></div></pre></td></tr></table></figure><ul><li>如果对象的属性名是动态的，可以在创造对象的时候，使用属性表达式定义</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">id: <span class="number">5</span>,</div><div class="line">name: <span class="string">'San Francisco'</span>,</div><div class="line">&#125;;</div><div class="line">obj[getKey(<span class="string">'enabled'</span>)] = <span class="literal">true</span>;<span class="string">'</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">// good</span></div><div class="line"><span class="string">const obj = &#123;</span></div><div class="line"><span class="string">id: 5,</span></div><div class="line"><span class="string">name: '</span>San Francisco<span class="string">',</span></div><div class="line"><span class="string">[getKey('</span>enabled<span class="string">')]: true,</span></div><div class="line"><span class="string">&#125;;</span></div></pre></td></tr></table></figure><ul><li>上面代码中，对象<code>obj</code>的最后一个属性名，需要计算得到。这时最好采用属性表达式，在新建<code>obj</code>的时候，将该属性与其他属性定义在一起。这样一来，所有属性就在一个地方定义了</li><li>另外，对象的属性和方法，尽量采用简洁表达法，这样易于描述和书写。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">ar ref = <span class="string">'some value'</span>;</div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> atom = &#123;</div><div class="line">ref: ref,</div><div class="line">value: <span class="number">1</span>,</div><div class="line">addValue: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> atom.value + value;</div><div class="line">&#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> atom = &#123;</div><div class="line">ref,</div><div class="line">value: <span class="number">1</span>,</div><div class="line">addValue(value) &#123;</div><div class="line"><span class="keyword">return</span> atom.value + value;</div><div class="line">&#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure><h2 id="五、数组"><a href="#五、数组" class="headerlink" title="五、数组"></a>五、数组</h2><hr><ul><li>使用扩展运算符<code>（...）</code>拷贝数组</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> len = items.length;</div><div class="line"><span class="keyword">const</span> itemsCopy = [];</div><div class="line"><span class="keyword">let</span> i;</div><div class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">itemsCopy[i] = items[i];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> itemsCopy = [...items];</div></pre></td></tr></table></figure><ul><li>使用<code>Array.from</code>方法，将类似数组的对象转为数组</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.foo'</span>);</div><div class="line"><span class="keyword">const</span> nodes = <span class="built_in">Array</span>.from(foo);</div></pre></td></tr></table></figure><h2 id="六、函数"><a href="#六、函数" class="headerlink" title="六、函数"></a>六、函数</h2><hr><ul><li>立即执行函数可以写成箭头函数的形式</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Welcome to the Internet.'</span>);</div><div class="line">&#125;)();</div></pre></td></tr></table></figure><ul><li>那些需要使用函数表达式的场合，尽量用箭头函数代替。因为这样更简洁，而且绑定了this</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> x * x;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function">(<span class="params">x</span>) =&gt;</span> &#123;</div><div class="line"><span class="keyword">return</span> x * x;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><ul><li>箭头函数取代<code>Function.prototype.bind</code>，不应再用<code>self/_this/that</code>绑定 <code>this</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> self = <span class="keyword">this</span>;</div><div class="line"><span class="keyword">const</span> boundMethod = <span class="function"><span class="keyword">function</span>(<span class="params">...params</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> method.apply(self, params);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// acceptable</span></div><div class="line"><span class="keyword">const</span> boundMethod = method.bind(<span class="keyword">this</span>);</div><div class="line"></div><div class="line"><span class="comment">// best</span></div><div class="line"><span class="keyword">const</span> boundMethod = <span class="function">(<span class="params">...params</span>) =&gt;</span> method.apply(<span class="keyword">this</span>, params);</div></pre></td></tr></table></figure><ul><li>所有配置项都应该集中在一个对象，放在最后一个参数，布尔值不可以直接作为参数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b, option = false </span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b, &#123; option = false &#125; = &#123;&#125;</span>) </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>不要在函数体内使用<code>arguments</code>变量，使用<code>rest</code>运算符<code>（...）</code>代替。因为<code>rest</code>运算符显式表明你想要获取参数，而且<code>arguments</code>是一个类似数组的对象，而<code>rest</code>运算符可以提供一个真正的数组</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">const</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</div><div class="line"><span class="keyword">return</span> args.join(<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params">...args</span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> args.join(<span class="string">''</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>使用默认值语法设置函数参数的默认值</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts</span>) </span>&#123;</div><div class="line">opts = opts || &#123;&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts = &#123;&#125;</span>) </span>&#123;</div><div class="line"><span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="七、Map结构"><a href="#七、Map结构" class="headerlink" title="七、Map结构"></a>七、Map结构</h2><hr><ul><li>注意区分<code>Object</code>和<code>Map</code>，只有模拟实体对象时，才使用<code>Object</code>。如果只是需要<code>key:value</code>的数据结构，使用<code>Map</code>。因为<code>Map</code>有内建的遍历机制</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(arr);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.keys()) &#123;</div><div class="line"><span class="built_in">console</span>.log(key);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.values()) &#123;</div><div class="line"><span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.entries()) &#123;</div><div class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>], item[<span class="number">1</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="八、Class"><a href="#八、Class" class="headerlink" title="八、Class"></a>八、Class</h2><hr><ul><li>总是用<code>class</code>，取代需要<code>prototype</code>操作。因为<code>class</code>的写法更简洁，更易于理解</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params">contents = []</span>) </span>&#123;</div><div class="line"><span class="keyword">this</span>._queue = [...contents];</div><div class="line">&#125;</div><div class="line">Queue.prototype.pop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">const</span> value = <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line"><span class="keyword">this</span>._queue.splice(<span class="number">0</span>, <span class="number">1</span>);</div><div class="line"><span class="keyword">return</span> value;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span> </span>&#123;</div><div class="line"><span class="keyword">constructor</span>(contents = []) &#123;</div><div class="line"><span class="keyword">this</span>._queue = [...contents];</div><div class="line">&#125;</div><div class="line">pop() &#123;</div><div class="line"><span class="keyword">const</span> value = <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line"><span class="keyword">this</span>._queue.splice(<span class="number">0</span>, <span class="number">1</span>);</div><div class="line"><span class="keyword">return</span> value;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>使用<code>extends</code>实现继承，因为这样更简单，不会有破坏<code>instanceof</code>运算的危险</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> inherits = <span class="built_in">require</span>(<span class="string">'inherits'</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PeekableQueue</span>(<span class="params">contents</span>) </span>&#123;</div><div class="line">Queue.apply(<span class="keyword">this</span>, contents);</div><div class="line">&#125;</div><div class="line">inherits(PeekableQueue, Queue);</div><div class="line">PeekableQueue.prototype.peek = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeekableQueue</span> <span class="keyword">extends</span> <span class="title">Queue</span> </span>&#123;</div><div class="line">peek() &#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="九、模块"><a href="#九、模块" class="headerlink" title="九、模块"></a>九、模块</h2><hr><ul><li><code>Module</code>语法是<code>JavaScript</code>模块的标准写法，坚持使用这种写法。使用<code>import</code>取代<code>require</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> moduleA = <span class="built_in">require</span>(<span class="string">'moduleA'</span>);</div><div class="line"><span class="keyword">const</span> func1 = moduleA.func1;</div><div class="line"><span class="keyword">const</span> func2 = moduleA.func2;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">import</span> &#123; func1, func2 &#125; <span class="keyword">from</span> <span class="string">'moduleA'</span>;</div></pre></td></tr></table></figure><ul><li>使用<code>export</code>取代<code>module.exports</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// commonJS的写法</span></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</div><div class="line"><span class="keyword">var</span> Breadcrumbs = React.createClass(&#123;</div><div class="line">render() &#123;</div><div class="line"><span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">nav</span> /&gt;</span>;</span></div><div class="line"><span class="xml">&#125;</span></div><div class="line"><span class="xml">&#125;);</span></div><div class="line"><span class="xml">module.exports = Breadcrumbs;</span></div><div class="line"><span class="xml"></span></div><div class="line"><span class="xml">// ES6的写法</span></div><div class="line"><span class="xml">import React from 'react';</span></div><div class="line"><span class="xml">const Breadcrumbs = React.createClass(&#123;</span></div><div class="line"><span class="xml">render() &#123;</span></div><div class="line"><span class="xml">return <span class="tag">&lt;<span class="name">nav</span> /&gt;</span>;</span></div><div class="line"><span class="xml">&#125;</span></div><div class="line"><span class="xml">&#125;);</span></div><div class="line"><span class="xml">export default Breadcrumbs</span></div></pre></td></tr></table></figure><ul><li>不要在模块输入中使用通配符。因为这样可以确保你的模块之中，有一个默认输出（export default）</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> myObject <span class="string">'./importModule'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">import</span> myObject <span class="keyword">from</span> <span class="string">'./importModule'</span>;</div></pre></td></tr></table></figure><ul><li>如果模块默认输出一个函数，函数名的首字母应该小写</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeStyleGuide</span>(<span class="params"></span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> makeStyleGuide;</div></pre></td></tr></table></figure><ul><li>如果模块默认输出一个对象，对象名的首字母应该大写</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> StyleGuide = &#123;</div><div class="line">es6: &#123;</div><div class="line">&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> StyleGuide;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;一、块级作用域&quot;&gt;&lt;a href=&quot;#一、块级作用域&quot; class=&quot;headerlink&quot; title=&quot;一、块级作用域&quot;&gt;&lt;/a&gt;一、块级作用域&lt;/h2&gt;&lt;hr&gt;
&lt;h3 id=&quot;1-1-let取代var&quot;&gt;&lt;a href=&quot;#1-1-let取代var&quot; cl
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="ES6" scheme="http://blog.poetries.top/tags/ES6/"/>
    
  </entry>
  
  <entry>
    <title>浅谈闭包</title>
    <link href="http://blog.poetries.top/2017/03/22/closure-summary/"/>
    <id>http://blog.poetries.top/2017/03/22/closure-summary/</id>
    <published>2017-03-22T06:24:08.000Z</published>
    <updated>2017-10-15T13:34:11.932Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>闭包的形成跟变量的作用域以及变量的生存周期密切相关</p></blockquote><h2 id="一、变量的作用域-是指变量的有效范围"><a href="#一、变量的作用域-是指变量的有效范围" class="headerlink" title="一、变量的作用域,是指变量的有效范围"></a>一、变量的作用域,是指变量的有效范围</h2><ul><li>当在函数中声明一个变量的时候,如果该变量前面没有带上关键字 <code>var</code>,这个变量就会成为全局变量 ,这当然是一种很容易造成命名冲突的做法。<br>另外一种情况是用 <code>var</code> 关键字在函数中声明变量,这时候的变量即是局部变量,只有在该函数内部才能访问到这个变量,在函数外面是访问不到的。</li></ul><p>例：变量的搜索是从内到外而非从外到 内的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a=<span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> func1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">    <span class="keyword">var</span> b=<span class="number">2</span>;</div><div class="line">    <span class="keyword">var</span> func2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">        <span class="keyword">var</span> c=<span class="number">3</span>;</div><div class="line">        <span class="built_in">console</span>.log ( b ); <span class="comment">// 输出:2 </span></div><div class="line">        <span class="built_in">console</span>.log ( a );<span class="comment">// 输出:1</span></div><div class="line">    &#125;</div><div class="line">    func2();</div><div class="line">    <span class="built_in">console</span>.log(c);<span class="comment">//输出:Uncaught ReferenceError: c is not defined</span></div><div class="line">&#125;; </div><div class="line">func1();</div></pre></td></tr></table></figure><h2 id="二、变量的生存周期"><a href="#二、变量的生存周期" class="headerlink" title="二、变量的生存周期"></a>二、变量的生存周期</h2><ul><li>对于全局变量来说,全局变量的生存周期当然是的永久,除非我们主动销毁这个全局变量。</li><li>而对于在函数内用<code>var</code>关键字声明的局部变量来说,当退出函数时,这些局部变量即失去了 它们的价值,它们都会随着函数的调用的结束而销毁</li></ul><p>例一：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">    <span class="keyword">var</span> a=<span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">        a++;</div><div class="line">        <span class="built_in">console</span>.log(a);</div><div class="line">    &#125; </div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> f=func();</div><div class="line">f();<span class="comment">// 输出:2 </span></div><div class="line">f();<span class="comment">// 输出:3</span></div><div class="line">f();<span class="comment">// 输出:4</span></div><div class="line">f();<span class="comment">// 输出:5</span></div></pre></td></tr></table></figure><ul><li>跟我们之前的结论相反,上面的例子在当退出函数后,局部变量<code>a</code> 并没有消失,而是似乎一直在某个地方 存活着。这是因为当执行 <code>var f = func();</code>时,<code>f</code> 返回了一个名函数的引用,它可以问到<code>func()</code> 被调用时产生的环境,而局部变量 <code>a</code> 一直处在这个环境里。既然外局部变量所在的环境还能被外 界访问,这个局部变量就有了不被销毁的理由。在这里生了一个闭包结构,局部变量的声明看起来被延续了。</li></ul><p>例二，假设页面上有 5 个 div 节点,我们通过循环来给每个 div绑定 onclick 事件,按照索引顺序,点击第 1 个 div 时弹出 0,点击第 2 个 div 时出 1,以此类</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> nodes = <span class="built_in">document</span>.getElementsByTagName( <span class="string">'div'</span> );</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,len=nodes.length;i&amp;lt;len;i++)&#123; </div><div class="line">    nodes[ i ].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(i); </div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><ul><li>测试这段代码会发现,无论点击哪个 div,最后弹出的结果都是 5</li><li>这是因为 <code>div</code> 节点的 <code>onclick</code> 事件是被异步触发的,当事件被触发的时候,<code>for</code>循环早已结束,此时 i 的值已经是 <code>5</code>,</li><li>所以在 <code>div</code>的 <code>onclick</code> 事件函数中顺着作用域链从内到外查找变量 i 时,查找到的值总是 <code>5</code>。</li><li>解决方法是在闭包的帮助下,每次循环的<code>i</code> 值都封闭起来。当在事件函数中顺着作用域链从内到外查找变量 <code>i</code>时,会先找到被封闭在闭包环境中的<code>i,</code>如果有<code>5</code>个<code>div</code>,这里的<code>i</code>分别 是 <code>0,1,2,3,4</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,len=nodes.length;i&amp;lt;len;i++)&#123; </div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"> i </span>)</span>&#123;</div><div class="line">        nodes[ i ].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">            <span class="built_in">console</span>.log(i);</div><div class="line">        &#125; </div><div class="line">    &#125;)(i)</div><div class="line">&#125;;</div></pre></td></tr></table></figure><h2 id="三、闭包的作用"><a href="#三、闭包的作用" class="headerlink" title="三、闭包的作用"></a>三、闭包的作用</h2><h3 id="1、封装变量—-闭包可以帮助一些不需要暴露在全局的变量封装成“私有变量”"><a href="#1、封装变量—-闭包可以帮助一些不需要暴露在全局的变量封装成“私有变量”" class="headerlink" title="1、封装变量—-闭包可以帮助一些不需要暴露在全局的变量封装成“私有变量”"></a>1、封装变量—-闭包可以帮助一些不需要暴露在全局的变量封装成“私有变量”</h3><ul><li>例一，计算乘积</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">    <span class="keyword">var</span> a=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,l=<span class="built_in">arguments</span>.length;i&amp;lt;l;i++)&#123; </div><div class="line">        a = a * <span class="built_in">arguments</span>[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> a; </div><div class="line">&#125;;</div></pre></td></tr></table></figure><h3 id="2、延续局部变量的寿命"><a href="#2、延续局部变量的寿命" class="headerlink" title="2、延续局部变量的寿命"></a>2、延续局部变量的寿命</h3><h2 id="四、闭包与内存泄漏"><a href="#四、闭包与内存泄漏" class="headerlink" title="四、闭包与内存泄漏"></a>四、闭包与内存泄漏</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(++i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> b;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> c = a();</div><div class="line">c();</div></pre></td></tr></table></figure><ul><li>首先有一个封闭的函数<code>a</code>（即自定义的一个<code>function a()</code>方法），该函数内部的变量<code>b</code>（局部变量/局部方法）外部无法直接调用；但如果把这个函数赋值给一个全部变量<code>c</code>时，</li><li>全局变量c就获取到了函数局部变量b的值，从而使局部变量<code>b</code>的值得到了保存，即延长了一个局部变量<code>b</code>的生命周期，除非主动销毁这个全局变量<code>c</code>。<br>此时，我们也就制造出来了一个“闭包”。简单说“闭包是指有权限访问另一个函数作用域的变量的函数”。</li><li>在这个过程中，因为局部变量b的声明周期延长，使得<code>Javascript</code>的垃圾回收机制不会收回函数<code>a</code>所占用的资源,因为函数a的局部变量<code>b</code>的执行需要依赖函数a中的变量。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;闭包的形成跟变量的作用域以及变量的生存周期密切相关&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;一、变量的作用域-是指变量的有效范围&quot;&gt;&lt;a href=&quot;#一、变量的作用域-是指变量的有效范围&quot; class=&quot;headerlink&quot; tit
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="JavaScript" scheme="http://blog.poetries.top/tags/JavaScript/"/>
    
      <category term="闭包" scheme="http://blog.poetries.top/tags/%E9%97%AD%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>Vue学习总结(一)</title>
    <link href="http://blog.poetries.top/2017/03/19/vue-summary-1/"/>
    <id>http://blog.poetries.top/2017/03/19/vue-summary-1/</id>
    <published>2017-03-19T04:24:08.000Z</published>
    <updated>2017-10-15T13:34:11.960Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p><img src="http://upload-images.jianshu.io/upload_images/1480597-628462457f124619.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p><ul><li><code>Vue</code>是一套构建用户界面的 渐进式框架。<code>Vue</code> 的核心库只关注视图层，并且非常容易学习，非常容易与其它库或已有项目整合。</li></ul><h2 id="二、Vue实例"><a href="#二、Vue实例" class="headerlink" title="二、Vue实例"></a>二、Vue实例</h2><p><strong>构造器</strong></p><ul><li>每个 <code>Vue.js</code> 应用都是通过构造函数 <code>Vue</code> 创建一个 <code>Vue</code> 的根实例 启动的</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line"><span class="comment">// 选项</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><ul><li>在实例化 <code>Vue</code> 时，需要传入一个选项对象，它可以包含数据、模板、挂载元素、方法、生命周期钩子等选项。全部的选项可以在 <code>API</code> 文档中查看</li></ul><p><strong>属性与方法</strong></p><ul><li>每个 <code>Vue</code>实例都会代理其<code>data</code> 对象里所有的属性</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</div><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">data: data</div><div class="line">&#125;)</div><div class="line">vm.a === data.a</div><div class="line"><span class="comment">// -&gt; true</span></div><div class="line"><span class="comment">// 设置属性也会影响到原始数据</span></div><div class="line">vm.a = <span class="number">2</span></div><div class="line">data.a <span class="comment">// -&gt; 2</span></div><div class="line"><span class="comment">// ... 反之亦然</span></div><div class="line">data.a = <span class="number">3</span></div><div class="line">vm.a <span class="comment">// -&gt; 3</span></div></pre></td></tr></table></figure><ul><li>除了 <code>data</code>属性， <code>Vue</code>实例暴露了一些有用的实例属性与方法。这些属性与方法都有前缀 <code>$</code>，以便与代理的<code>data</code>属性区分。例如：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</div><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">el: <span class="string">'#example'</span>,</div><div class="line">data: data</div><div class="line">&#125;)</div><div class="line">vm.$data === data</div><div class="line"><span class="comment">// -&gt; true</span></div><div class="line">vm.$el === <span class="built_in">document</span>.getElementById(<span class="string">'example'</span>)</div><div class="line"><span class="comment">// -&gt; true</span></div><div class="line"><span class="comment">// $watch 是一个实例方法</span></div><div class="line">vm.$watch(<span class="string">'a'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">newVal, oldVal</span>) </span>&#123;</div><div class="line"><span class="comment">// 这个回调将在 `vm.a` 改变后调用</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><p><strong>实例生命周期</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">data: &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;,</div><div class="line">created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"><span class="comment">// `this` 指向 vm 实例</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'a is: '</span> + <span class="keyword">this</span>.a)</div><div class="line">&#125;</div><div class="line">&#125;)</div><div class="line"><span class="comment">// -&gt; "a is: 1"</span></div></pre></td></tr></table></figure><ul><li>也有一些其它的钩子，在实例生命周期的不同阶段调用，如 <code>mounted</code> 、 <code>updated</code> 、 <code>destroyed</code> 。钩子的 <code>this</code> 指向调用它的 <code>Vue</code> 实例。一些用户可能会问 <code>Vue.js</code> 是否有“控制器”的概念？答案是，没有。组件的自定义逻辑可以分布在这些钩子中</li></ul><p><strong>生命周期图示</strong></p><p><img src="./images/1489915053427.jpg" alt="生命周期图示" title="1489915053427"></p><h2 id="三、模板语法"><a href="#三、模板语法" class="headerlink" title="三、模板语法"></a>三、模板语法</h2><ul><li><p><code>Vue.js</code> 使用了基于 <code>HTML</code> 的模版语法，允许开发者声明式地将 <code>DOM</code> 绑定至底层 <code>Vue</code> 实例的数据。所有<code>Vue.js</code> 的模板都是合法的 <code>HTML</code> ，所以能被遵循规范的浏览器和 <code>HTML</code> 解析器解析。</p></li><li><p>在底层的实现上， <code>Vue</code>将模板编译成虚拟<code>DOM</code> 渲染函数。结合响应系统，在应用状态改变时， <code>Vue</code> 能够智能地计算出重新渲染组件的最小代价并应用到 <code>DOM</code> 操作上。</p></li></ul><h3 id="插值"><a href="#插值" class="headerlink" title="插值"></a>插值</h3><p><strong>文本</strong></p><ul><li>数据绑定最常见的形式就是使用 “Mustache” 语法（双大括号）的文本插值</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Message: &#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div></pre></td></tr></table></figure><ul><li><code>Mustache</code> 标签将会被替代为对应数据对象上 <code>msg</code> 属性的值。无论何时，绑定的数据对象上 <code>msg</code> 属性发生了改变，插值处的内容都会更新</li><li>通过使用 <code>v-once</code> 指令，你也能执行一次性地插值，当数据改变时，插值处的内容不会更新。但请留心这会影响到该节点上所有的数据绑定</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-once</span>&gt;</span>This will never change: &#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>纯 HTML</strong></p><ul><li>双大括号会将数据解释为纯文本，而非 <code>HTML</code> 。为了输出真正的 <code>HTML</code>，你需要使用<code>v-html</code>指令：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"rawHtml"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>被插入的内容都会被当做 <code>HTML</code> —— 数据绑定会被忽略</li><li>你的站点上动态渲染的任意 <code>HTML</code> 可能会非常危险，因为它很容易导致 <code>XSS</code> 攻击。请只对可信内容使用<code>HTML</code> 插值，绝不要对用户提供的内容插值</li></ul><p><strong>属性</strong></p><ul><li>Mustache 不能在 <code>HTML</code> 属性中使用，应使用 <code>v-bind</code> 指令：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">"dynamicId"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>使用 JavaScript 表达式</strong></p><ul><li>对于所有的数据绑定， <code>Vue.js</code>都提供了完全的 <code>JavaScript</code>表达式支持。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; number + 1 &#125;&#125;&#123;&#123; ok ? 'YES' : 'NO' &#125;&#125;</div><div class="line">&#123;&#123; message.split('').reverse().join('') &#125;&#125;</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">"'list-' + id"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>这些表达式会在所属 Vue 实例的数据作用域下作为 JavaScript 被解析</li></ul><p><strong>过滤器</strong></p><ul><li><code>Vue.js</code> 允许你自定义过滤器，被用作一些常见的文本格式化。过滤器应该被添加在<code>mustache</code> 插值的尾部，由“管道符”指示：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; message | capitalize &#125;&#125;</div></pre></td></tr></table></figure><p><strong>指令</strong></p><ul><li>指令（<code>Directives</code>）是带有<code>v-</code>前缀的特殊属性。指令属性的值预期是单一 <code>JavaScript</code>表达式（除了<code>v-for</code> ，之后再讨论）</li><li>指令的职责就是当其表达式的值改变时相应地将某些行为应用到 DOM 上</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">"seen"</span>&gt;</span>Now you see me<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>这里， <code>v-if</code> 指令将根据表达式 seen 的值的真假来移除/插入<code>&lt;p&gt;</code>元素</li></ul><p><strong>参数</strong></p><ul><li>一些指令能接受一个“参数”，在指令后以冒号指明。例如，<code>v-bind</code>指令被用来响应地更新 <code>HTML</code> 属性</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">"url"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure><ul><li><p>在这里 <code>href</code>是参数，告知<code>v-bind</code> 指令将该元素的 <code>href</code> 属性与表达式 <code>url</code>的值绑定</p></li><li><p>另一个例子是 <code>v-on</code> 指令，它用于监听 <code>DOM</code> 事件：</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">"doSomething"</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>修饰符</strong></p><ul><li>修饰符（Modifiers）是以半角句号<code>.</code>指明的特殊后缀，用于指出一个指令应该以特殊方式绑定</li><li>例如，<code>.prevent</code> 修饰符告诉 <code>v-on</code> 指令对于触发的事件调用 <code>event.preventDefault()</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">v-on:submit.prevent</span>=<span class="string">"onSubmit"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>缩写</strong></p><ul><li><code>v-</code> 前缀在模板中是作为一个标示 <code>Vue</code> 特殊属性的明显标识</li><li><p><code>Vue.js</code> 为两个最为常用的指令提供了特别的缩写</p></li><li><p><code>v-bind</code> 缩写</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 完整语法 --&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">"url"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 缩写 --&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">"url"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure><ul><li><code>v-on</code> 缩写</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 完整语法 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">"doSomething"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 缩写 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> @<span class="attr">click</span>=<span class="string">"doSomething"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="四、计算属性"><a href="#四、计算属性" class="headerlink" title="四、计算属性"></a>四、计算属性</h2><ul><li>在模板中绑定表达式是非常便利的，但是它们实际上只用于简单的操作。在模板中放入太多的逻辑会让模板过重且难以维护。例如：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span> &#123;&#123; message.split('').reverse().join('') &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>在这种情况下，模板不再简单和清晰。在实现反向显示 <code>message</code> 之前，你应该确认它。这个问题在你不止一次反向显示 <code>message</code> 的时候变得更加糟糕。</li><li>这就是为什么任何复杂逻辑，你都应当使用计算属性</li></ul><p><strong>基础例子</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span> </div><div class="line">   <span class="tag">&lt;<span class="name">p</span>&gt;</span>Original message: "&#123;&#123; message &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </div><div class="line">   <span class="tag">&lt;<span class="name">p</span>&gt;</span>Computed reversed message: "&#123;&#123; reversedMessage &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123; </div><div class="line">el: <span class="string">'#example'</span>, <span class="attr">data</span>: &#123; <span class="attr">message</span>: <span class="string">'Hello'</span> &#125;, </div><div class="line">computed: &#123;</div><div class="line">  <span class="comment">//a computed getter </span></div><div class="line">reversedMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; </div><div class="line">  <span class="comment">// `this` points to the vm instance </span></div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</div><div class="line">&#125; &#125;&#125;)</div></pre></td></tr></table></figure><ul><li><p>结果：</p><ul><li>Original message: “Hello”</li><li>Computed reversed message: “olleH”</li></ul></li><li><p>这里我们声明了一个计算属性 <code>reversedMessage</code> 。我们提供的函数将用作属性</p></li></ul><p><strong>计算缓存 vs Methods</strong></p><ul><li>你可能已经注意到我们可以通过调用表达式中的<code>method</code>来达到同样的效果：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Reversed message: "&#123;&#123; reverseMessage() &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// in component</span></div><div class="line">methods: &#123;</div><div class="line">reverseMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">'</span></div><div class="line"><span class="string">'</span>).reverse().join(<span class="string">''</span>) </div><div class="line">&#125;&#125;</div></pre></td></tr></table></figure><ul><li><p>不经过计算属性，我们可以在 <code>method</code> 中定义一个相同的函数来替代它。对于最终的结果，两种方式确实是相同的。然而，不同的是计算属性是基于它的依赖缓存。计算属性只有在它的相关依赖发生改变时才会重新<br>取值。这就意味着只要 <code>message</code> 没有发生改变，多次访问<code>reversedMessage</code> 计算属性会立即返回之前的计算结果，而不必再次执行函数。</p></li><li><p>这也同样意味着如下计算属性将不会更新，因为 <code>Date.now()</code>不是响应式依赖：</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">computed: &#123; <span class="attr">now</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Date</span>.now() &#125;&#125;</div></pre></td></tr></table></figure><ul><li><p>相比而言，每当重新渲染的时候，<code>method</code> 调用总会执行函数</p></li><li><p>我们为什么需要缓存？假设我们有一个重要的计算属性 <code>A</code> ，这个计算属性需要一个巨大的数组遍历和做大量的计算。然后我们可能有其他的计算属性依赖于 <code>A</code> 。如果没有缓存，我们将不可避免的多次执行 <code>A</code> 的 <code>getter</code>！如果你不希望有缓存，请用 <code>method</code> 替代</p></li></ul><p><strong>计算属性 vs Watched Property</strong></p><ul><li><code>Vue.js</code> 提供了一个方法<code>$watch</code> ，它用于观察 <code>Vue</code>实例上的数据变动</li></ul><p><strong>计算 setter</strong></p><ul><li>计算属性默认只有 <code>getter</code>，不过在需要时你也可以提供一个 <code>setter</code>：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">computed: &#123;</div><div class="line">fullName: &#123; </div><div class="line">   <span class="comment">// getter </span></div><div class="line">get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; </div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>.firstName + <span class="string">' '</span> + <span class="keyword">this</span>.lastName </div><div class="line">&#125;, </div><div class="line"><span class="comment">// setter </span></div><div class="line">set: <span class="function"><span class="keyword">function</span> (<span class="params">newValue</span>) </span>&#123;</div><div class="line"><span class="keyword">var</span> names = newValue.split(<span class="string">' '</span>) </div><div class="line"><span class="keyword">this</span>.firstName = names[<span class="number">0</span>] </div><div class="line"><span class="keyword">this</span>.lastName = names[names.length - <span class="number">1</span>] </div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;&#125;</div></pre></td></tr></table></figure><ul><li>现在在运行<code>vm.fullName = &#39;John Doe&#39;</code> 时， <code>setter</code>会被调用， <code>vm.firstName</code> 和<code>vm.lastName</code> 也会被对应更新</li></ul><p><strong>观察 Watchers</strong></p><ul><li>虽然计算属性在大多数情况下更合适，但有时也需要一个自定义的 <code>watcher</code> 。这是为什么 <code>Vue</code> 提供一个更通用的方法通过 <code>watch</code> 选项，来响应数据的变化。当你想要在数据变化响应时，执行异步操作或昂贵操作时，这是很有用的</li></ul><h2 id="五、Class与Style绑定"><a href="#五、Class与Style绑定" class="headerlink" title="五、Class与Style绑定"></a>五、Class与Style绑定</h2><h3 id="Class-与-Style-绑定"><a href="#Class-与-Style-绑定" class="headerlink" title="Class 与 Style 绑定"></a>Class 与 Style 绑定</h3><ul><li>数据绑定一个常见需求是操作元素的 <code>class</code> 列表和它的内联样式。因为它们都是属性 ，我们可以用 <code>v-bind</code>处理它们：只需要计算出表达式最终的字符串。不过，字符串拼接麻烦又易错。因此，在 <code>v-bind</code> 用于<code>class</code> 和 <code>style</code>时， <code>Vue.js</code> 专门增强了它。表达式的结果类型除了字符串之外，还可以是对象或数组</li></ul><h3 id="绑定-HTML-Class"><a href="#绑定-HTML-Class" class="headerlink" title="绑定 HTML Class"></a>绑定 HTML Class</h3><p><strong>对象语法</strong></p><ul><li>我们可以传给<code>v-bind:class</code> 一个对象，以动态地切换 <code>class</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">"&#123; active: isActive &#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>上面的语法表示<code>class active</code>的更新将取决于数据属性<code>isActive</code> 是否为真值</li><li>我们也可以在对象中传入更多属性用来动态切换多个<code>class</code>。此外， v-<code>bind:class</code> 指令可以与普通的<code>class</code> 属性共存。如下模板:</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"static"</span> <span class="attr">v-bind:class</span>=<span class="string">"&#123; active: isActive, 'text-danger': hasError &#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>如下 <code>data</code>:</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data: &#123; <span class="attr">isActive</span>: <span class="literal">true</span>, <span class="attr">hasError</span>: <span class="literal">false</span>&#125;</div></pre></td></tr></table></figure><ul><li>渲染为:</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"static active"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li><p>当 <code>isActive</code> 或者 <code>hasError</code> 变化时，<code>class</code> 列表将相应地更新。例如，如果 <code>hasError</code>的值为<code>true</code> ， <code>class</code>列表将变为<code>&quot;static active text-danger&quot;</code></p></li><li><p>你也可以直接绑定数据里的一个对象</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">"classObject"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data: &#123; <span class="attr">classObject</span>: &#123; <span class="attr">active</span>: <span class="literal">true</span>, <span class="string">'text-danger'</span>: <span class="literal">false</span> &#125;&#125;</div></pre></td></tr></table></figure><p><strong>数组语法</strong></p><ul><li>我们可以把一个数组传给 <code>v-bind:class</code> ，以应用一个 <code>class</code> 列表</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">"[activeClass, errorClass]"</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data: &#123; <span class="attr">activeClass</span>: <span class="string">'active'</span>, <span class="attr">errorClass</span>: <span class="string">'text-danger'</span>&#125;</div></pre></td></tr></table></figure><ul><li>渲染为:</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"active text-danger"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>如果你也想根据条件切换列表中的 <code>class</code> ，可以用三元表达式</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">"[isActive ? activeClass : '', errorClass]"</span>&gt;</span></div></pre></td></tr></table></figure><h3 id="绑定内联样式"><a href="#绑定内联样式" class="headerlink" title="绑定内联样式"></a>绑定内联样式</h3><p><strong>对象语法</strong></p><ul><li><code>v-bind:style</code> 的对象语法十分直观——看着非常像<code>CSS</code> ，其实它是一个 <code>JavaScript</code> 对象。 <code>CSS</code> 属性名可以用驼峰式（camelCase）或短横分隔命名（kebab-case）</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> </span></div><div class="line"><span class="tag"><span class="attr">v-bind:style</span>=<span class="string">"&#123; color: activeColor, fontSize: fontSize + 'px' &#125;"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data: &#123; <span class="attr">activeColor</span>: <span class="string">'red'</span>, <span class="attr">fontSize</span>: <span class="number">30</span>&#125;</div></pre></td></tr></table></figure><ul><li>直接绑定到一个样式对象通常更好，让模板更清晰</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:style</span>=<span class="string">"styleObject"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data: &#123; <span class="attr">styleObject</span>: &#123; <span class="attr">color</span>: <span class="string">'red'</span>, <span class="attr">fontSize</span>: <span class="string">'13px'</span> &#125;&#125;</div></pre></td></tr></table></figure><p><strong>数组语法</strong></p><ul><li><code>v-bind:style</code> 的数组语法可以将多个样式对象应用到一个元素上</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:style</span>=<span class="string">"[baseStyles, overridingStyles]"</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>自动添加前缀</strong></p><ul><li>当 <code>v-bind:style</code> 使用需要特定前缀的 <code>CSS</code> 属性时，如 <code>transform</code> ，<code>Vue.js</code>会自动侦测并添加相应的前缀</li></ul><h2 id="六、条件渲染"><a href="#六、条件渲染" class="headerlink" title="六、条件渲染"></a>六、条件渲染</h2><p><strong>v-if</strong></p><ul><li>在字符串模板中，如 <code>Handlebars</code>，我们得像这样写一个条件块</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;!-- Handlebars 模板 --&gt;</div><div class="line">&#123;&#123;#if ok&#125;&#125; &lt;h1&gt;Yes&lt;/h1&gt;&#123;&#123;/if&#125;&#125;</div></pre></td></tr></table></figure><ul><li>在 <code>Vue.js</code>，我们使用 <code>v-if</code>指令实现同样的功能</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-if</span>=<span class="string">"ok"</span>&gt;</span>Yes<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>也可以用 <code>v-else</code>添加一个 <code>“else”</code>块</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-if</span>=<span class="string">"ok"</span>&gt;</span>Yes<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-else</span>&gt;</span>No<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>template v-if</strong></p><ul><li>因为 <code>v-if</code> 是一个指令，需要将它添加到一个元素上。但是如果我们想切换多个元素呢？此时我们可以把一个 <code>&lt;template&gt;</code> 元素当做包装元素，并在上面使用 <code>v-if</code> ，最终的渲染结果不会包含它</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"ok"</span>&gt;</span> <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>v-else</strong></p><ul><li><p>可以用 <code>v-else</code>指令给 <code>v-if</code>或 <code>v-show</code> 添加一个 <code>“else”</code> 块</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"Math.random() &gt; 0.5"</span>&gt;</span> Sorry<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span> Not sorry<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p><code>v-else</code> 元素必须紧跟在<code>v-if</code>或 <code>v-show</code> 元素的后面——否则它不能被识别</p></li></ul><p><strong>v-show</strong></p><ul><li>另一个根据条件展示元素的选项是<code>v-show</code>指令。用法大体上一样</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-show</span>=<span class="string">"ok"</span>&gt;</span>Hello!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure><ul><li><p>不同的是有 <code>v-show</code> 的元素会始终渲染并保持在 <code>DOM</code> 中。 <code>v-show</code>是简单的切换元素的 <code>CSS</code> 属性<code>display</code></p></li><li><p>注意 <code>v-show</code> 不支持 <code>&lt;template&gt;</code> 语法</p></li></ul><p><strong>v-if vs. v-show</strong></p><ul><li><code>v-if</code> 是真实的条件渲染，因为它会确保条件块在切换当中适当地销毁与重建条件块内的事件监听器和子组件</li><li><code>v-if</code>也是惰性的：如果在初始渲染时条件为假，则什么也不做</li><li>相比之下， <code>v-show</code> 简单得多——元素始终被编译并保留，只是简单地基于 <code>CSS</code> 切换</li><li>一般来说， <code>v-if</code>有更高的切换消耗而 <code>v-show</code> 有更高的初始渲染消耗</li><li>因此，如果需要频繁切换使用<code>v-show</code>较好，如果在运行时条件不大可能改变则使用<code>v-if</code>较好</li></ul><h2 id="七、列表渲染"><a href="#七、列表渲染" class="headerlink" title="七、列表渲染"></a>七、列表渲染</h2><p><strong>v-for</strong></p><ul><li>我们用 <code>v-for</code>指令根据一组数组的选项列表进行渲染。<code>v-for</code>指令需要以 <code>item in items</code> 形式的特殊语法， <code>items</code> 是源数据数组并且 <code>item</code> 是数组元素迭代的别名</li><li>在 <code>v-for</code> 块中，我们拥有对父作用域属性的完全访问权限。 <code>v-for</code> 还支持一个可选的第二个参数为当前项的索引</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"example-2"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in items"</span>&gt;</span> </div><div class="line">&#123;&#123; parentMessage &#125;&#125; - &#123;&#123; index &#125;&#125; - &#123;&#123; item.message &#125;&#125; </div><div class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>你也可以用 <code>of</code>替代 <code>in</code>作为分隔符，因为它是最接近 <code>JavaScript</code> 迭代器的语法</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"item of items"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>Template v-for</strong></p><ul><li>如同 <code>v-if</code>模板，你也可以用带有 <code>v-for</code> 的 <code>&lt;template&gt;</code>标签来渲染多个元素块。例如：<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"item in items"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123; item.msg &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure></li></ul><p><strong>对象迭代 v-for</strong></p><ul><li>你也可以用<code>v-for</code> 通过一个对象的属性来迭代</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"repeat-object"</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"value in object"</span>&gt;</span> &#123;&#123; value &#125;&#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">el: <span class="string">'#repeat-object'</span>, </div><div class="line">data: &#123; </div><div class="line">object: &#123;</div><div class="line">FirstName: <span class="string">'John'</span>, </div><div class="line">LastName: <span class="string">'Doe'</span>, <span class="attr">Age</span>: <span class="number">30</span></div><div class="line">&#125; </div><div class="line">&#125;&#125;)</div></pre></td></tr></table></figure><ul><li><p>你也可以提供第二个的参数为键名</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"(value, key) in object"</span>&gt;</span> &#123;&#123; key &#125;&#125; : &#123;&#123; value &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>第三个参数为索引</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"(value, key, index) in object"</span>&gt;</span></div><div class="line">&#123;&#123; index &#125;&#125;. &#123;&#123; key &#125;&#125; : &#123;&#123; value &#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></li></ul><p><strong>整数迭代 v-for</strong></p><ul><li><code>v-for</code> 也可以取整数。在这种情况下，它将重复多次模板</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-for</span>=<span class="string">"n in 10"</span>&gt;</span>&#123;&#123; n &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>结果： 1 2 3 4 5 6 7 8 9 10</li></ul><p><strong>组件 和 v-for</strong></p><ul><li><p>在自定义组件里，你可以像任何普通元素一样用 <code>v-for</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">v-for</span>=<span class="string">"item in items"</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>然而他不能自动传递数据到组件里，因为组件有自己独立的作用域。为了传递迭代数据到组件里，我们要用<code>props</code></p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in items"</span> </span></div><div class="line"><span class="tag"><span class="attr">v-bind:item</span>=<span class="string">"item"</span> <span class="attr">v-bind:index</span>=<span class="string">"index"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span>&gt;</div></pre></td></tr></table></figure><ul><li>不自动注入 <code>item</code>到组件里的原因是，因为这使得组件会紧密耦合到 <code>v-for</code>如何运作。在一些情况下，明确数据的来源可以使组件可重用。</li></ul><h2 id="八、事件处理器"><a href="#八、事件处理器" class="headerlink" title="八、事件处理器"></a>八、事件处理器</h2><p><strong>监听事件</strong></p><ul><li>可以用 <code>v-on</code> 指令监听 <code>DOM</code> 事件来触发一些 <code>JavaScript</code> 代码</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example-1"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"counter += 1"</span>&gt;</span>增加 1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这个按钮被点击了 &#123;&#123; counter &#125;&#125; 次。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> example1 = <span class="keyword">new</span> Vue(&#123; </div><div class="line">el: <span class="string">'#example-1'</span>, </div><div class="line">data: &#123; </div><div class="line">counter: <span class="number">0</span> </div><div class="line">&#125;&#125;)</div></pre></td></tr></table></figure><p><strong>方法事件处理器</strong></p><ul><li>许多事件处理的逻辑都很复杂，所以直接把 <code>JavaScript</code> 代码写在 <code>v-on</code> 指令中是不可行的。因此 <code>v-on</code> 可以接收一个定义的方法来调用</li></ul><p><strong>内联处理器方法</strong></p><ul><li>除了直接绑定到一个方法，也可以用内联 <code>JavaScript</code>语句</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example-3"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"say('hi')"</span>&gt;</span>Say hi<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"say('what')"</span>&gt;</span>Say what<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">el: <span class="string">'#example-3'</span>, </div><div class="line">methods: &#123; </div><div class="line">say: <span class="function"><span class="keyword">function</span> (<span class="params">message</span>) </span>&#123; </div><div class="line">alert(message) </div><div class="line">&#125;</div><div class="line">&#125;&#125;)</div></pre></td></tr></table></figure><ul><li>有时也需要在内联语句处理器中访问原生 <code>DOM</code> 事件。可以用特殊变量 <code>$event</code>把它传入方法</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">button</span> </span></div><div class="line"><span class="tag"><span class="attr">v-on:click</span>=<span class="string">"warn('Form cannot be submitted yet.', $event)"</span>&gt;</span></div><div class="line">Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">methods: &#123;</div><div class="line">warn: <span class="function"><span class="keyword">function</span> (<span class="params">message, event</span>) </span>&#123;</div><div class="line"><span class="comment">// 现在我们可以访问原生事件对象 </span></div><div class="line"><span class="keyword">if</span>(event) &#123;</div><div class="line">event.preventDefault() </div><div class="line">alert(message) </div><div class="line">&#125;</div><div class="line">&#125;&#125;</div></pre></td></tr></table></figure><p><strong>事件修饰符</strong></p><ul><li>在事件处理程序中调用<code>event.preventDefault()</code>或<code>event.stopPropagation()</code>是非常常见的需求。尽管我们可以在<code>methods</code> 中轻松实现这点，但更好的方式是：<code>methods</code> 只有纯粹的数据逻辑，而不是去处理<code>DOM</code> 事件细节</li><li>为了解决这个问题， <code>Vue.js</code> 为 <code>v-on</code>提供了 事件修饰符。通过由点(<code>.</code>)表示的指令后缀来调用修饰符</li><li><code>.stop</code></li><li><code>.prevent</code></li><li><code>.capture</code></li><li><code>.self</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 阻止单击事件冒泡 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click.stop</span>=<span class="string">"doThis"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 提交事件不再重载页面 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">v-on:submit.prevent</span>=<span class="string">"onSubmit"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 修饰符可以串联 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click.stop.prevent</span>=<span class="string">"doThat"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 只有修饰符 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">v-on:submit.prevent</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 添加事件侦听器时使用时间捕获模式 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-on:click.capture</span>=<span class="string">"doThis"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 只当事件在该元素本身（而不是子元素）触发时触发回调 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-on:click.self</span>=<span class="string">"doThat"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>按键修饰符</strong></p><ul><li>在监听键盘事件时，我们经常需要监测常见的键值。 <code>Vue</code>允许为 <code>v-on</code>在监听键盘事件时添加按键修饰符：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 只有在 keyCode 是 13 时调用 vm.submit() --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-on:keyup.13</span>=<span class="string">"submit"</span>&gt;</span></div></pre></td></tr></table></figure><ul><li><p>记住所有的 <code>keyCode</code>比较困难，所以 <code>Vue</code>为最常用的按键提供了别名</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 同上 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-on:keyup.enter</span>=<span class="string">"submit"</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 缩写语法 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> @<span class="attr">keyup.enter</span>=<span class="string">"submit"</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>全部的按键别名：</p><ul><li><code>enter</code></li><li><code>tab</code></li><li><code>delete</code> (捕获 “删除” 和 “退格” 键)</li><li><code>esc</code></li><li><code>space</code></li><li><code>up</code></li><li><code>down</code></li><li><code>left</code></li><li><code>right</code></li></ul></li></ul><p><strong>为什么在 HTML 中监听事件?</strong></p><ul><li><p>你可能注意到这种事件监听的方式违背了关注点分离（separation of concern）传统理念。不必担心，因为所有的 <code>Vue.js</code>事件处理方法和表达式都严格绑定在当前视图的 <code>ViewModel</code>上，它不会导致任何维护上的困难。</p></li><li><p>实际上，使用 <code>v-on</code>有几个好处</p><ul><li>扫一眼<code>HTML</code> 模板便能轻松定位在 <code>JavaScript</code>代码里对应的方法</li><li>因为你无须在 <code>JavaScript</code>里手动绑定事件，你的 <code>ViewModel</code>代码可以是非常纯粹的逻辑，和 <code>DOM</code> 完全解耦，更易于测试。</li><li>当一个 <code>ViewModel</code>被销毁时，所有的事件处理器都会自动被删除。你无须担心如何自己清理它们。</li></ul></li></ul><h2 id="九、表单控制绑定"><a href="#九、表单控制绑定" class="headerlink" title="九、表单控制绑定"></a>九、表单控制绑定</h2><p><strong>基础用法</strong></p><ul><li>你可以用 <code>v-model</code>指令在表单控件元素上创建双向数据绑定</li><li>它会根据控件类型自动选取正确的方法来更新元素。</li><li>尽管有些神奇，但 <code>v-model</code>本质上不过是语法糖，它负责监听用户的输入事件以更新数据，并特别处理一些极端的例子。</li><li><code>v-model</code> 并不关心表单控件初始化所生成的值。因为它会选择<code>Vue</code>实例数据来作为具体的值。</li></ul><p><strong>文本</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"message"</span> <span class="attr">placeholder</span>=<span class="string">"edit me"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Message is: &#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>复选框</strong></p><ul><li>单个勾选框，逻辑值</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"checked"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"checkbox"</span>&gt;</span>&#123;&#123; checked&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>多个勾选框，绑定到同一个数组</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"jack"</span> <span class="attr">value</span>=<span class="string">"Jack"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"jack"</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"john"</span> <span class="attr">value</span>=<span class="string">"John"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"john"</span>&gt;</span>John<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"mike"</span> <span class="attr">value</span>=<span class="string">"Mike"</span> <span class="attr">v-model</span>=<span class="string">"checkedN</span></span></div><div class="line"><span class="tag"><span class="string">ames"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"mike"</span>&gt;</span>Mike<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Checked names: &#123;&#123; checkedNames &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Vue(&#123; <span class="attr">el</span>: <span class="string">'...'</span>, <span class="attr">data</span>: &#123; <span class="attr">checkedNames</span>: [] &#125;&#125;)</div></pre></td></tr></table></figure><h2 id="十、组件"><a href="#十、组件" class="headerlink" title="十、组件"></a>十、组件</h2><h3 id="什么是组件？"><a href="#什么是组件？" class="headerlink" title="什么是组件？"></a>什么是组件？</h3><ul><li>组件（Component）是 <code>Vue.js</code> 最强大的功能之一。组件可以扩展<code>HTML</code>元素，封装可重用的代码。在较高层面上，组件是自定义元素，<code>Vue.js</code> 的编译器为它添加特殊功能。在有些情况下，组件也可以是原生 <code>HTML</code> 元<br>素的形式，以<code>is</code> 特性扩展</li></ul><h3 id="使用组件"><a href="#使用组件" class="headerlink" title="使用组件"></a>使用组件</h3><p><strong>注册</strong></p><ul><li>之前说过，我们可以通过以下方式创建一个 <code>Vue</code>实例</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Vue(&#123; <span class="attr">el</span>: <span class="string">'#some-element'</span>, <span class="comment">// 选项&#125;)</span></div></pre></td></tr></table></figure><ul><li><p>要注册一个全局组件，你可以使用 <code>Vue.component(tagName, options) 。</code>例如：<code>Vue.component(&#39;my-component&#39;, { // 选项})</code></p></li><li><p>组件在注册之后，便可以在父实例的模块中以自定义元素 <code>&lt;my-component&gt;&lt;/my-component&gt;</code> 的形式使用。要确保在初始化根实例 之前 注册了组件：<code>&lt;div id=&quot;example&quot;&gt; &lt;my-component&gt;&lt;/my-component&gt;&lt;/div&gt;</code></p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 注册</span></div><div class="line">Vue.component(<span class="string">'my-component'</span>, </div><div class="line">&#123; <span class="attr">template</span>: <span class="string">'&lt;div&gt;A custom component!&lt;/div&gt;'</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">//创建根实例</span></div><div class="line"><span class="keyword">new</span> Vue(&#123; <span class="attr">el</span>: <span class="string">'#example'</span>&#125;)</div></pre></td></tr></table></figure><ul><li>渲染为：<code>&lt;div id=&quot;example&quot;&gt; &lt;div&gt;A custom component!&lt;/div&gt;&lt;/div&gt;</code></li></ul><p><strong>局部注册</strong></p><ul><li>不必在全局注册每个组件。通过使用组件实例选项注册，可以使组件仅在另一个实例/组件的作用域中可用</li></ul><p><strong>构成组件</strong></p><ul><li>组件意味着协同工作，通常父子组件会是这样的关系：组件 A 在它的模版中使用了组件 B 。它们之间必然需要相互通信：父组件要给子组件传递数据，子组件需要将它内部发生的事情告知给父组件。然而，在一个良<br>好定义的接口中尽可能将父子组件解耦是很重要的。这保证了每个组件可以在相对隔离的环境中书写和理解，也大幅提高了组件的可维护性和可重用性</li><li>在 <code>Vue.js</code>中，父子组件的关系可以总结为 <code>props down</code>, <code>events up</code> 。父组件通过 <code>props</code> 向下传递数据给子组件，子组件通过 <code>events</code>给父组件发送消息。看看它们是怎么工作的</li></ul><p><img src="./images/1489926033814.jpg" alt="enter description here" title="1489926033814"></p><h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><p><strong>使用Props传递数据</strong></p><ul><li>组件实例的作用域是孤立的。这意味着不能并且不应该在子组件的模板内直接引用父组件的数据。可以使用<code>props</code>把数据传给子组件。</li><li><code>prop</code>是父组件用来传递数据的一个自定义属性。子组件需要显式地用 <code>props</code> 选项 声明 <code>“prop”：</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Vue.component(<span class="string">'child'</span>, &#123; </div><div class="line"><span class="comment">// 声明 props</span></div><div class="line">props: [<span class="string">'message'</span>],</div><div class="line"><span class="comment">// 就像 data 一样，prop 可以用在模板内</span></div><div class="line"><span class="comment">// 同样也可以在 vm 实例中像 “this.message” 这样使用</span></div><div class="line">template: <span class="string">'&lt;span&gt;&#123;&#123; message&#125;&#125;&lt;/span&gt;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">'</span>&#125;)</div></pre></td></tr></table></figure><ul><li>然后向它传入一个普通字符串<code>&lt;child message=&quot;hello!&quot;&gt;&lt;/child&gt;</code></li><li>结果：hello!</li></ul><p><strong>动态 Props</strong></p><ul><li>类似于用<code>v-bind</code> 绑定 <code>HTML</code> 特性到一个表达式，也可以用 <code>v-bind</code> 绑定动态 <code>props</code>到父组件的数据。每当父组件的数据变化时，也会传导给子组件：</li></ul><p><strong>单向数据流</strong></p><ul><li><code>prop</code>是单向绑定的：当父组件的属性变化时，将传导给子组件，但是不会反过来。这是为了防止子组件无意修改了父组件的状态——这会让应用的数据流难以理解</li><li>另外，每次父组件更新时，子组件的所有 <code>prop</code>都会更新为最新值。这意味着你不应该在子组件内部改变<code>prop</code> 。如果你这么做了，<code>Vue</code> 会在控制台给出警告</li></ul><h2 id="十一、附录"><a href="#十一、附录" class="headerlink" title="十一、附录"></a>十一、附录</h2><h3 id="附录一-MVC、MVP、MVVM模式对比"><a href="#附录一-MVC、MVP、MVVM模式对比" class="headerlink" title="附录一 MVC、MVP、MVVM模式对比"></a>附录一 MVC、MVP、MVVM模式对比</h3><h4 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h4><hr><h5 id="什么是MVC"><a href="#什么是MVC" class="headerlink" title="什么是MVC"></a>什么是MVC</h5><hr><ul><li>MVC是一种模式，它将应用分为3个部分：数据（模型）、表现层（视图）、用户交互层（控制器）</li><li>一个事件的处理大概是这样<ul><li>用户和应用产生交互</li><li>控制器的事件处理器被触发</li><li>控制器从模型中请求数据，并将其交给视图</li><li>视图将数据呈现给用户</li></ul></li></ul><h5 id="模型（数据保存）"><a href="#模型（数据保存）" class="headerlink" title="模型（数据保存）"></a>模型（数据保存）</h5><hr><ul><li>模型用来存放用户的所有数据对象。比如有一个user模型，用来存放用户列表、他们的属性以及所有和模型有关的逻辑</li><li>模型不必知晓视图和控制器的细节，模型只需包含数据以及直接和这些数据相关的逻辑</li></ul><h5 id="视图（用户界面）"><a href="#视图（用户界面）" class="headerlink" title="视图（用户界面）"></a>视图（用户界面）</h5><hr><ul><li>视图是呈现给用户的，用户与之产生交互。在JavaScript应用中，视图大都是由HTML、css、JavaScript模板组成的</li></ul><h5 id="控制器（业务逻辑）"><a href="#控制器（业务逻辑）" class="headerlink" title="控制器（业务逻辑）"></a>控制器（业务逻辑）</h5><hr><ul><li>控制器是模型和视图之间的纽带。控制器从视图获得事件和输入，对它们进行进行处理，并相应的更新视图。</li><li>当页面加载时，控制器会给视图添加事件监听，比如监听表单提交或按钮点击。然后当用户和你的应用产生交互时，控制器中的事件触发器就开始工作了</li></ul><h5 id="总结一下："><a href="#总结一下：" class="headerlink" title="总结一下："></a>总结一下：</h5><hr><ul><li><code>Controller</code> 监听 <code>Model</code> 变化，<code>Model</code> 一变，<code>Controller</code> 就会去更新<code>View</code>。</li><li><p><code>Controller</code> 监听用户交互，用户点了提交或修改按钮，Controller 就要去更新 Model</p></li><li><p><code>View</code> 传送指令到 <code>Controller</code></p></li><li><code>Controller</code> 完成业务逻辑后，要求 <code>Model</code> 改变状态</li><li><code>Model</code> 将新的数据发送到 <code>View</code>，用户得到反馈</li></ul><p>各部分之间的通信方式</p><p><img src="http://image.beekka.com/blog/2015/bg2015020105.png" alt=""></p><h4 id="互动模式"><a href="#互动模式" class="headerlink" title="互动模式"></a>互动模式</h4><hr><ul><li>接受用户指令时，MVC 可以分成两种方式。一种是通过 View 接受指令，传递给 Controller</li></ul><p><img src="http://image.beekka.com/blog/2015/bg2015020106.png" alt=""></p><ul><li>另一种是直接通过controller接受指令</li></ul><p><img src="http://image.beekka.com/blog/2015/bg2015020107.png" alt=""></p><h4 id="MVP"><a href="#MVP" class="headerlink" title="MVP"></a>MVP</h4><hr><ul><li><code>MVP</code> 模式将 <code>Controller 改名为</code>Presenter`，同时改变了通信方向</li></ul><p><img src="http://image.beekka.com/blog/2015/bg2015020109.png" alt=""></p><ul><li>各部分之间的通信，都是双向的。</li><li><code>View</code> 与<code>Model</code> 不发生联系，都通过 <code>Presenter</code> 传递。</li><li><code>View</code> 非常薄，不部署任何业务逻辑，称为”被动视图”（Passive View），即没有任何主动性，而 Presenter非常厚，所有逻辑都部署在那里</li></ul><h4 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h4><hr><ul><li><code>MVVM</code> 模式将 <code>Presenter</code> 改名为 <code>ViewModel</code>，基本上与 <code>MVP</code> 模式完全一致</li><li>唯一的区别是，它采用双向绑定（data-binding）：<code>View</code>的变动，自动反映在 <code>ViewModel</code>，反之亦然</li></ul><p><img src="http://image.beekka.com/blog/2015/bg2015020110.png" alt=""></p><h3 id="附录二-vue与其他框架的对比"><a href="#附录二-vue与其他框架的对比" class="headerlink" title="附录二 vue与其他框架的对比"></a>附录二 vue与其他框架的对比</h3><h4 id="React"><a href="#React" class="headerlink" title="React"></a>React</h4><ul><li><code>React</code> 和 <code>Vue</code> 有许多相似之处，它们都有<ul><li>使用 <code>Virtual DOM</code></li><li>提供了响应式（Reactive）和组件化（Composable）的视图组件。</li><li>将注意力集中保持在核心库，伴随于此，有配套的路由和负责处理全局状态管理的库</li></ul></li></ul><h4 id="angular1"><a href="#angular1" class="headerlink" title="angular1"></a>angular1</h4><ul><li><code>Vue</code> 的一些语法和 <code>Angular</code>的很相似（例如 <code>v-if vs ng-if</code>）。因为<code>Angular</code>是 <code>Vue</code>早期开发的灵感来源。然而，Angular 中存在的许多问题，在 Vue 中已经得到解决</li></ul><p><strong>复杂性</strong></p><ul><li>在 <code>API</code> 与设计两方面上<code>Vue.js</code>都比 <code>Angular 1</code> 简单得多，因此你可以快速地掌握它的全部特性并投入开发。</li></ul><p><strong>灵活性和模块化</strong></p><ul><li><code>Vue.js</code> 是一个更加灵活开放的解决方案。它允许你以希望的方式组织应用程序，而不是在任何时候都必须遵循 <code>Angular 1</code>制定的规则，这让<code>Vue</code>能适用于各种项目。我们知道把决定权交给你是非常必要的</li></ul><p><strong>数据绑定</strong></p><ul><li><code>Angular 1</code>使用双向绑定，<code>Vue</code> 在不同组件间强制使用单向数据流。这使应用中的数据流更加清晰易懂。</li></ul><p><strong>指令与组件</strong></p><ul><li>在 <code>Vue</code> 中指令和组件分得更清晰。指令只封装 <code>DOM</code> 操作，而组件代表一个自给自足的独立单元 —— 有自己的视图和数据逻辑。在 <code>Angular</code> 中两者有不少相混的地方</li></ul><p><strong>性能</strong></p><ul><li><code>Vue</code> 有更好的性能，并且非常非常容易优化，因为它不使用脏检查</li><li>在 <code>Angular 1</code> 中，当 <code>watchers</code> 越来越多时会变得越来越慢，因为作用域内的每一次变化，所有 <code>watchers</code>都要重新计算。并且，如果一些<code>watchers</code>触发另一个更新，脏检查循环（digest cycle）可能要运行多次。Angular 用户常常要使用深奥的技术，以解决脏检查循环的问题。有时没有简单的办法来优化有大量 <code>watchers</code>的作用域</li><li><code>Vue</code> 则根本没有这个问题，因为它使用基于依赖追踪的观察系统并且异步队列更新，所有的数据变化都是独立触发，除非它们之间有明确的依赖关系</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;一、介绍&quot;&gt;&lt;a href=&quot;#一、介绍&quot; class=&quot;headerlink&quot; title=&quot;一、介绍&quot;&gt;&lt;/a&gt;一、介绍&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/148059
      
    
    </summary>
    
      <category term="Front-End" scheme="http://blog.poetries.top/categories/Front-End/"/>
    
    
      <category term="Vue" scheme="http://blog.poetries.top/tags/Vue/"/>
    
  </entry>
  
</feed>
